\documentclass[a4paper,12pt]{scrartcl}
\usepackage[colorlinks=True,linkcolor=blue,urlcolor=orange]{hyperref}
\usepackage{fancyvrb}
\usepackage{xcolor}
\usepackage{amssymb}
\usepackage{makeidx}

\makeatletter
\def\namedlabel#1#2{\begingroup
    #2%
    \def\@currentlabel{#2}%
    \phantomsection\label{#1}\endgroup
}
\def\verbatim@font{\linespread{1}\normalfont\ttfamily}
\makeatother
\makeindex

% Title Page
\title{A guide to the Tight-Binding FITting (\tbfitname{}) package}
\author{Hyun-Jung Kim [h.kim@fz-juelich.de, Infant@kias.re.kr]}
\newcommand{\testsuite}{\textcolor{blue}{\texttt{testsuite}}}
\newcommand{\testcase}{\textcolor{green}{\texttt{testcase}}}
\newcommand{\testparameter}{\textcolor{red}{\texttt{testparameter}}}
\newcommand{\tbfitname}{\textcolor{blue!85!white}{\texttt{TBFIT}}}
\newcommand{\textred}[1]{\textcolor{red!85!white}{\texttt{#1}}}
\newcommand{\textblue}[1]{\textcolor{blue!85!white}{\texttt{#1}}}
\newcommand{\textgreen}[1]{\textcolor{green!50!black}{\texttt{#1}}}
\newcommand{\textpink}[1]{\textcolor{red!60!yellow}{\texttt{#1}}}
\begin{document}
\maketitle

\begin{abstract}
This document is to provide explanation for the input file arguments of the \tbfitname{} package.

\end{abstract}
\section*{\label{sec:INSTALL}{System Requirements and installation}}

The program has been written by modern \texttt{Fortran2008} language. If you want to deactivate the use of some module interfaces written in Fortran2008 syntax, please remove \texttt{-DF08} option in your option tag of the makefile. \\

\texttt{LAPACK} library should be properly linked in the makefile. For the eigenvalue solver with sparse matrix, \href{https://software.intel.com/en-us/mkl-developer-reference-fortran-inspector-executor-sparse-blas-routines}{\texttt{Inspector-executor Sparse BLAS Routines}} and \href{https://software.intel.com/en-us/mkl-developer-reference-fortran-extended-eigensolver-routines}{\texttt{Extended Eigensolver Routines}} in the \texttt{Intel Math Kernel Library (Intel MKL)} are refered. If the system size is very big, you can calculate band structure with energy window constraint. This is available with \ref{tag:EWINDOW} tag and \textblue{-DMKL\_SPARSE} option. To use \textblue{-DMKL\_SPARSE} option, make sure that \texttt{mkl\_spblas.f90} file is located in your \texttt{\$MKLPATH/include} folder. \\

To list up the space group information for the given geometry in the initial stages of the calculations, one can activate the use of space group library (\href{https://atztogo.github.io/spglib/#}{Spglib}). For this, put \textblue{\label{tag:SPGLIBO}{-DSPGLIB}} in your \texttt{OPTION} tag of the \texttt{makefile}, and provide appropriate library path in \textblue{SPGLIB} tag.

		\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
		   	label= \texttt{makefile} example ,
		   	labelposition=bottomline]
				\#----------------------------------|
				\# Compiler options and bin path    |
				\#----------------------------------|
				OPTIONS= -fpp -DF08 -DSPGLIB -DMKL_SPARSE
				F90    = mpif90 \$(OPTIONS)
				FFLAG  = -O3 -heap-arrays -nogen-interfaces
				MPI_USE = YES
				BIN    = ~/code/bin

				\#----------------------------------|
				\# Dependencies: LAPACK, SPGLIB     |
				\#----------------------------------|
				SPGLIB = -L/Users/Infant/code/lib/ -lsymspg
				MKLPATH= \$(MKLROOT)
				LAPACK = -L\$(MKLPATH)/lib/
					 -lmkl_intel_lp64 -lmkl_sequential
					 -lmkl_core -liomp5
		\end{Verbatim}

$\bullet$ How to install:
	\begin{Verbatim}
	 > tar -xvf TBFIT-master.zip
	 > cd TBFIT-master
	 > make tbfit.mpi (if MPI_USE=YES)
	 > make tbfit.serial (if MPI_USE=NO)
	\end{Verbatim}
$\bullet$ How to run:

\indent In the \texttt{Example} directory, you can run a test cases, for example:
	\begin{Verbatim}
	 > cd TBFIT-master/Example/1H-MoS2/SOC
	 > tbfit
	\end{Verbatim}
\indent \indent Note that the output log will be written in \texttt{TBFIT.out} file by default. If you want to write the log with different name, please use -log option as follows:
    \begin{verbatim}
        > tbfit -log FNAME.out
    \end{verbatim}

\indent Note also that the input arguments are read from \texttt{INCAR-TB} by default. However, if you want to provide your prefer file, you can specify by \texttt{-i} or \texttt{-input} option as follows:
    \begin{verbatim}
        > tbfit -i INCAR-TB_test
    \end{verbatim}

\indent If you want to fit multiple target band, you can fit them in a single command line.
\indent For example, if you have define system \texttt{A} in \texttt{INCAR-TB\_A} and  system \texttt{B} in \texttt{INCAR-TB\_B}, you can run them simultaneously as follows:
    \begin{verbatim}
        > tbfit -i INCAR-TB_A -i INCAR-TB_B
    \end{verbatim}
\indent The output will be written in separate files with numbered index. Important note is that, for a fitting purpose, you should provide \texttt{SAME} parameter file for each system. This is because we assume a situation where the fitting parameter fit multiple system in a single run.\\


$\bullet$ python module:
\indent The \tbfitname{} supports python module as of version 0.5.1. To utilize python module \texttt{tbfitpy}, compile python module and import \texttt{tbfitpy} which is located in \texttt{PYTHON\_MODULE} folder.
	\begin{Verbatim}
	 > make tbfitpy_mod
	\end{Verbatim}
	After successful compilation, \texttt{\_tbfitpy\_mod\_mpi.*so} file and
	\texttt{tbfitpy\_mod\_mpi.py} file will be generated (if MPI = NO in your make file,
	\texttt{\_mpi} suffix will be removed). 
	Then, copy these files and tbfitpy.py into your \texttt{\$PYTHONPATH}.
	The prerequisites for the python modules are as follows: \\
	\indent $\odot$  \href{https://github.com/jameskermode/f90wrap}{\texttt{f90wrap}}, \href{https://numpy.org}{\texttt{NumPy}}, \href{https://matplotlib.org/}{\texttt{Matplotlib}}, \href{https://pyswarms.readthedocs.io/en/latest/}{\texttt{PySwarms}}, \href{https://github.com/tqdm/tqdm}{\texttt{tqdm}}, \href{https://github.com/mpi4py/mpi4py}{\texttt{mpi4py}} \\
	
	The example can be found in the ``\texttt{Example/Graphene/BAND\_FIT/\\Step\_3.pso\_method/1.PSO/1.NPARTICLE\_50/python\_module}" of your example folder.

\newpage
\part{User's Guide}

\section{INPUT tags of the \texttt{INCAR-TB}}

\begin{description}

    \item[\namedlabel{tag:TITLE}{TITLE}] $string$ Default: $none$ \index{TITLE}
		The title of the system can be specified with this tag.
		Note that there should be no blank as this \texttt{TITLE} tag can be used in extension of the several output/input file name.
		
		For example, one can specify as follows:
		
		\begin{verbatim}
		 TITLE Graphene-1ML
		\end{verbatim}

		 Then, the output for band structure will be written in
		\begin{verbatim}
	 band_structure_TBA.Graphene-1ML.dat
		\end{verbatim}

    \item[\namedlabel{tag:GETBAND}{GET\_BAND}] $logical$ Default: \texttt{.TRUE.} \index{GET\_BAND}
		If \texttt{.TRUE.} \tbfitname{} will perform tight-binding calculations 
		for band structure evaluation.
		
    \item[\namedlabel{tag:TBFIT}{TBFIT}] $logical$ Default: \texttt{.FALSE.}  \index{TBFIT}
		\subitem \texttt{.TRUE.}  : Perform tight-binding parameter fitting 
			which is defined in \ref{tag:PFILE}. After fitting is 
			completed, whatever it is converged or not, 
			additional tight binding calculations as defined 
			in the \texttt{INCAR-TB} will be performed.
		\subitem \texttt{.FALSE.} : Do not perform fitting procedures. 
			In this case, regular tight binding calculations 
        	will be performed.

    \item[\namedlabel{tag:MITER}{MITER}] $integer$ Default: \texttt{100} \index{MITER} \\
		Maximum number of iteration of the \ref{tag:LMDIF} fitting procedures. If \ref{tag:GA} is set for \ref{tag:LSTYPE}, \ref{tag:MITER} represents the maximum number of generations.

% deprecated
%    \item[\namedlabel{tag:MXFIT}{MXFIT}] $integer$ Default: \texttt{1}  \index{MXFIT} \\
%		Maximum number of repeat for LMDIF procedures after \ref{tag:MITER} steps done.
%		By checking convergence criteria defined by FDIF the variation of the fitness function, parameter constraints, i.e., upper or lower bounds defined by SET CONSTRAINT tags, TBFIT will determine to stop or not. 

    \item[\namedlabel{tag:LSTYPE}{LSTYPE}] $string$ Default: \texttt{LMDIF} \index{LSTYPE} \\
        Method for parameter fitting. Available tags are \texttt{LMDIF} and \texttt{GA} and \texttt{PSO}.
        
		\subitem \namedlabel{tag:LMDIF}{\texttt{LMDIF}} method\index{LSTYPE!LMDIF}: Levenberg-Marquardt method\footnote{ Kenneth Levenberg, 
		"A Method for the Solution of Certain Non-Linear Problems in Least Squares" 
		$Quarterly$ $of$ $Applied$ $Mathematics$ 2, 164 (1944).}$^,$
		\footnote{Donald Marquardt, "An Algorithm for Least-Squares Estimation of 
		Nonlinear Parameters" $SIAM$ $Journal$ $on$ $Applied$ $Mathematics$ 11, 
		431 (1963).} using finite-difference for Jacobian.
		
		\subitem \namedlabel{tag:GA}{\texttt{GA}} method\index{LSTYPE!GA}\index{LSTYPE!GA+LMDIF}: Genetic Algorithm\footnote{D. E. Goldberg, ``Genetic Algorithm in Search, Optimization, \& Machine Learning" $Addison-Wesley$ (1989).} based on PIKAIA library\footnote{P. Charbonneau and B. Knapp, ``A user's guide to PIKAIA 1.0", (NCAR Technical Note 418+IA, 1995)}$^,$\footnote{P. Charbonneau, ``An introduction to genetic algorithm for numerical optimization" (NCAR Technical Note 450+IA, 2002)}$^,$\footnote{P. Charbonneau, ``Release notes for PIKAIA 1.2" (NCAR Technical Note 451+STR, 2002), \href{http://www.hao.ucar.edu/modeling/pikaia/pikaia.php}{http://www.hao.ucar.edu/modeling/pikaia/pikaia.php}}$^,$\footnote{Modern Fortran Edition of the Pikaia Genetic Algorithm. \href{https://github.com/jacobwilliams/pikaia}{https://github.com/jacobwilliams/pikaia}}. To setup control parameters for the \texttt{GA}, see Sec. \ref{tag:SET_GA}.
		
		\subitem \namedlabel{tag:PSO}{\texttt{PSO}}\index{PSO} method\index{LSTYPE!PSO}\index{LSTYPE!PSO+LMDIF}: Particle swarm optimization method\footnote{J. Kennedy and R. Eberhart, "Particle Swarm Optimization" (IEEE, Piscataway, NJ, 1995) p. 1942.}$^,$ \footnote{ R. Eberhart and J. Kennedy, "A new optimizer using particle swarm theory"	(IEEE, New York, NY, 1995).}. The control parameters to utilize PSO are: \ref{tag:PSONP}, \ref{tag:PSOOPT}. Note that, it is also possible to use \ref{tag:LMDIF} method in combination with \ref{tag:PSO}, i.e.,  \namedlabel{tag:PSOLMDIF}{\textblue{PSO+LMDIF}}\index{PSO!PSO+LMDIF} is also available.
			
    \item[\namedlabel{tag:PTOL}{PTOL} \& \namedlabel{tag:FTOL}{FTOL}] $real$ Default: 0.00001 \index{FTOL}\\
      	Tolerence of iteration of the fitting procedures for \ref{tag:LMDIF} method. 
	  	\texttt{FTOL} is a tolerence for the difference between target and 
      	calculated data from tight binding method. 
	  	\texttt{PTOL} is as tolerence for the tight binding parameters.
      	Normally, both values below 0.00001 is sufficient to reach 
	  	a local minima.

% deprecated
 %   \item[\namedlabel{tag:FDIFF}{FDIFF}] $real$ Default: 0.001 \index{FDIFF}\\
 %     	Tolerence of iteration of the fitting procedures for \ref{tag:LMDIF} method. 
%	  	\texttt{FDIFF} is a tolerence for the difference between fitness function of previous and last steps. After finishing LMDIF iterations, fitting procedures might start again if \textblue{CONSTRAINT} and \ref{tag:FDIFF} condition does not fulfill, and will stops by  \ref{tag:MXFIT} criteria.
	  	
	 \item[\namedlabel{tag:PSOMITER}{PSO\_MITER}] $integer$ Default: 10 \index{PSO!PSO\_MITER}\\
		Maximum number of iteration in \ref{tag:PSO} and \ref{tag:PSOLMDIF} method.
		  	
	 \item[\namedlabel{tag:PSONP}{PSO\_NP}] $integer$ Default: 50 \index{PSO!PSO\_NP}\\
		The number of particles in the swarm. This is critical value for the optimization result and should be larger if possible and one can have convergence test with this value.
	 \item[\namedlabel{tag:PSOOPT}{PSO\_OPT}] $real,real,real$ Default: {$c_1$=0.3, $c_2$=0.4, and $w$=0.2} \index{PSO!PSO\_OPT}\\
		The optional parameter for parameter update policy. In \ref{tag:PSO} method, the $i$-th parameter set ${\bold p}_i$ in the swarm is updated using its velocity vector ${\bold v}^{t+1}_i = w {\bold v}^{t}_i + c_1 r_1 ({\bold p}_{best, i}^t - {\bold p}_i^t) + c_2 r_2 ({\bold p}_{best}^t - {\bold p}_i^t) $ so that the updated parameter ${\bold p}_i^{t+1} = {\bold p}_i^{t} + {\bold v}_i^{t+1}$. Here, $w$ is the inertia weight and controls the momentum of the parameter update, $c_1$ is a self-confidence factor (cognitive) and expresses how much the particle trust its own past experience (${\bold p}_{best,i}$) while $c_2$ is a swarm confidence factor (social) and expresses how much it trusts the swarm's best experience (${\bold p}_{best}$). $r_1$ and $r_2$ is introduced to make swarm explore parameter space randomly searching for new best parameters. 
		\begin{verbatim}
		 PSO_OPT  0.3  0.4  0.2  # c1=0.3, c2=0.4, w=0.2
		\end{verbatim}

	 \item[\namedlabel{tag:PSONOISE}{PSO\_NOISE}] $real$ Default: 5.0 \index{PSO!PSO\_NOISE}\\
		Maximum amplitude of random noise added to the initial tight-binding parameters in \ref{tag:PSO}, $t' = t + random\_nosise$

	 \item[\namedlabel{tag:PSOREPORT}{PSO\_REPORT}] $logical$, $real$ Default: .TRUE., 0.2 \index{PSO!PSO\_REPORT}\\
		Logical flag whether allows to report best parameter sets out of all obtained set of parameter sets in \ref{tag:PSO} fitting method. The amount of parameters to be reported can be adjusted by $real$ rational number as follows:
		
		\begin{verbatim}
		 PSO_REPORT .TRUE.  0.3  # report 30% of best parameter sets out of 
		                         # PSO_NP parameter sets at the final step.
		\end{verbatim}
	
	 \item[\namedlabel{tag:PSOMODE}{PSO\_MODE}] $string$ Default: $pso$ \index{PSO!PSO\_MODE}\\
		Method in updating \ref{tag:PSO} scheme. The default \texttt{pso} uses original method. The modified method \texttt{pso\_bestn} updates \texttt{bestn} particles with random noises. That is, only the selected $best$ $n$ particles out of total parameter sets \ref{tag:PSONP} with applying random noises, will be updated for the next iteration. Here, $best$ particles refers parameter sets that gives better fitness to the target band structure. The number of best particles $n$ can be adjusted with the $real$ parameter in \ref{tag:PSOREPORT} tag. If you do not want to report best parameters but want to update with those parameter sets, you can specify as follows: 
		
		\begin{verbatim}
		 PSO_REPORT .FALSE.  0.3  # report 30% of best parameter sets out of 
		                         # PSO_NP parameter sets at the final step.
		 PSO_MODE PSO_BESTN # int(0.3*PSO_NP) parameters will be updated only.
       \end{verbatim}
		
		In this way, you can reach into converged value much faster than default \texttt{pso} method. However, please remember the famous quotes, \emph{``There is no free lunch''}. It is little bit risky since you may loose some chance to explore much broader parameter space. 
	 	 

    \item[\namedlabel{tag:FITPLAIN}{FIT\_PLAIN}] $logical$ \index{PSO!FIT\_PLAIN} Default: .FALSE. \\
		Logical flag whether we consider weight factor or not in cost function update in \ref{tag:PSO} fitting procedure (only available if \ref{tag:LSTYPE}= \ref{tag:PSO} or \ref{tag:PSOLMDIF}). \\ 
		.TRUE. : \ref{tag:PSO} iteration updates based on the cost without \ref{tag:WEIGHT}, \\
		.FALSE.: \ref{tag:PSO} iteration updates based on the cost with \ref{tag:WEIGHT}
		%NOTE: if \ref{tag:LSTYPE}= \ref{tag:PSO+LMDIF}) and \ref{tag:FITPLAIN} = \texttt{.TRUE.}.

    \item[\namedlabel{tag:NPAR}{NPAR}] $integer$ \index{PSO!NPAR} Default: 1 \\
		Number of parallel groups over \ref{tag:PSO} particles. 
		If larger than 1, It divides CPU into \texttt{NPAR} groups in PSO routine. 
		It is useful if number of k-points is less than number of total CPU.
			   	
    \item[\namedlabel{tag:KUNIT}{K\_UNIT}] $string$ Default: \texttt{ANGSTROM} \index{K\_UNIT}
		\subitem \texttt{ANGSTROM}   : the unit of the $k$-point will be written
			in \AA$^{-1}$ unit.
		\subitem \texttt{RECIPROCAL} : the unit of the $k$-point will be written
			in reciprocal unit (fractional).
			
    \item [\namedlabel{tag:PFILE}{PFILE}] $string$ Default: \texttt{PARAM\_FIT.dat} \index{PFILE}\\
		File name for tight-binding parameters.
		For the details, see Sec.\ref{tag:PFILE-detail}.
		
 \texttt{Note 1:} After fitting procedure is over, the \ref{tag:WEIGHT} information is 
 written in \ref{tag:PFILE} so that one can restart fitting. To use \ref{tag:WEIGHT} information written in \ref{tag:PFILE}, one can add \texttt{USE\_WEIGHT} tag as below:

		\begin{verbatim}
		 PFILE  PARAM_FIT.dat  USE_WEIGHT
		\end{verbatim}

		
    \item[\namedlabel{tag:POFILE}{POFILE}] $string$ \index{POFILE}
		Output file name for tight-binding parameters written after fitting 
		procedures. Default: \texttt{PARAM\_FIT.new.dat}
	
    \item[\namedlabel{tag:SPGLIB}{SGPLIB}] $logical$ \index{SPGLIB}
		\subitem \texttt{.TRUE.}  : Write space group information to the output log.
		\subitem \texttt{.FALSE.}  : Do not write space group information to the output log. \\
		
		Note that this option is only applicable if you have put \textblue{-DSPGLIB} option in your makefile . See the details in \texttt{System Requirements and installation} section.
	
    \item[\namedlabel{tag:EFILE}{EFILE}] $string, integer$ \index{EFILE} \\
		File name for the $target$ band structure for the fitting procedures. 
		If the second $integer$ $n$ is followed by,
		\tbfitname{} will read $n$-th column as a target band. Default is $n$=2.
		\begin{verbatim}
		 EFILE DFT_BANDSTRUCTURE.dat 2
		\end{verbatim}

		\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
		   	label= EFILE DFT\_BANDSTRUCTURE.out example ,
		   	labelposition=bottomline]
        \# 1st eigen value
        \# k-path  energy(eV)
          0.00000  -12.36137  
          0.01693  -12.36162  
          0.03386  -12.36118  
            [...]
          0.16932  -12.33324  
          0.18625  -12.32696  
          0.20319  -12.32014  


        \# 2nd eigen value
        \# k-path  energy(eV)
          0.00000  -12.36137  
          0.01693  -12.36041  
          0.03386  -12.35875  
             [...]
          0.16932  -12.32136  
          0.18625  -12.31394  
          0.20319  -12.30600  

            [...]
		\end{Verbatim}
		
		If \ref{tag:LORDER} = \texttt{.TRUE.} and  \ref{tag:TBFIT} = \texttt{.TRUE.}, re-ordered target energy information should be provided in parallel with the original energy, as below:
		\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
		   	label= EFILE DFT\_BANDSTRUCTURE\_ORDERED.out example ,
		   	labelposition=bottomline] 
		  \# k-path          energy(eV)     energy_ordered(eV) : 1st eig
       0.00000000     -14.75638384     -14.75638384
       0.04796527     -14.74941045     -14.74941045
            [...]
       2.95861071     -14.74708715     -14.74708715
       3.01399626     -14.75638384     -14.75638384

            [...]
            
		  \# k-path          energy(eV)     energy_ordered(eV) : 3rd eig
       0.00000000      -2.27711578      -2.27711578
       0.04796527      -2.27002886      -2.27002886
             [...]
       2.95861071      -2.26767593      -0.44510940
       3.01399626      -2.27711578      -0.44395430    
            [...]
		\end{Verbatim}
		
    	If the second argument is $VASP$,
		\tbfitname{} will read \texttt{EFILE} which is indicated as the first argument and recognize this file as a $EIGENVAL$ file of \texttt{VASP} code. (note: In this case, \ref{tag:LORDER} should be \texttt{.FALSE.}.) For example, 

		\begin{verbatim}
		 EFILE EIGENVAL VASP
		\end{verbatim}

	    \item[\namedlabel{tag:EFILE_EF}{EFILE\_EF}] $real$ \index{EFILE\_EF}\\
	    The fermi level of \ref{tag:EFILE}. The energy will be shifted by the \texttt{EFILE\_EF}, i.e., $\epsilon_{n,k}^{target} = \epsilon_{n,k}^{DFT} - \texttt{EFILE\_EF}$, where $\epsilon_{n,k}^{DFT}$ is the eigenvalues provided by the \ref{tag:EFILE}.

	
    \item[\namedlabel{tag:GFILE}{GFILE}] $string$ Default: \texttt{POSCAR-TB} \index{GFILE}\\
        File name for the geometry and atomic orbital informations. 
		The format is exactly same as \texttt{POSCAR} of \href{https://www.vasp.at}{\texttt{VASP}}
		program. For the details of setting atomic orbitals, see Sec.\ref{tag:GFILE-detail}.

    \begin{verbatim}
     GFILE POSCAR-TB
    \end{verbatim}
       
       The example file format of \texttt{"GFILE"} is as follows,

        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= POSCAR-TB example: MoS$_2$ with \texttt{Mo}-$d$ and \texttt{S}-$s$$p$,
            labelposition=bottomline]
     MoS2 \# comment
       1.00000000000000  \# scaling factor
         3.1716343    0.000000    0.00000  \# lattice vector a1
         1.5858171    2.746715    0.00000  \# lattice vector a2
         0.0000000    0.000000   15.00000  \# lattice vector a3
       Mo  S                               \# atomic species
         1   2                          \# number of atoms per species
     Direct     \# coordinate type (direct or cartesian)
      0.00000 0.00000 0.50000 dz2 dxy dx2 dyz dxz  # coord, orbital
      0.33333 0.33333 0.60645 s px py pz              
      0.33333 0.33333 0.39354 s px py pz

        \end{Verbatim}
        
        Note: TBFIT reads \texttt{"GFILE"} and reports it on to the screen in the parsing steps.
        If \texttt{"PRINT\_GEOM .FALSE."} tag is followed by, then program will not report the 
        geometry informations, for the convenience.
     \begin{verbatim}
     GFILE POSCAR-TB PRINT_GEOM .FALSE.
     \end{verbatim}


    \item[\namedlabel{tag:KFILE}{KFILE}] $string$ Default: \texttt{KPOINTS\_BAND} \index{KFILE} \\
        File name for the $k$-point setting.
        The format is exactly same as \texttt{KPOINTS} of \href{https://www.vasp.at}{\texttt{VASP}}
        program.

        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= KPOINTS\_BAND $line$ $mode$ example, 
            labelposition=bottomline]
     k-points line mode example
       40  ! intersections
     Line-mode
     Reciprocal
       0.50000000  0.5000000 0 M
       0.33333333  0.6666666 0 K
       
       0.33333333  0.6666666 0 K
       0.00000000  0.0000000 0 G
       
       0.00000000  0.0000000 0 G
       0.66666666  0.3333333 0 K'

        \end{Verbatim}

        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= KPOINTS\_BAND $grid$ $mode$ example, 
            labelposition=bottomline]
     k-points grid mode example
       0 
     GMonkhorst-Pack #'G'amma centered grid mode
       4  4  1   \# grid  nk_1 nk_2 nk_3
       0  0  0   \# shift
        \end{Verbatim}

    Note1: In \href{https://www.vasp.at}{\texttt{VASP}}, $n$ $k$-points are generated along a $k$-path if $n$ 
    division is specified in the second line of \texttt{KFILE}. This will gives $n \times m$ total $k$-points and $n-1$ divisions along each $k$-path, where $m$ represents the total number of $k$-path specified. And at the end of each line segment of $k$-path, same $k$-points are marked twice. 
    However, some program, 
    such as \href{http://www.flapw.de}{\texttt{FLEUR}} uses different strategy 
    in generating $k$-path, that is, 
    $n+1$ $k$-points along each path with only one $k$-points at the end
    of line segments. Hence, \ref{tag:EFILE} originated (or postprocessed) 
    from \texttt{FLEUR-v26} would have different format.
    This will gives $n \times m + 1$ total $k$-points and $n$ division of 
    each $k$-path. You can read this kind of \ref{tag:EFILE} file as well, if you have 
    also specify as below, letting \ref{tag:TBFIT} to recognize the type of 
    generated $k$-path as FLEUR.
    
     \begin{verbatim}
     KFILE KPOINTS_BAND  FLEUR
     \end{verbatim}
    
    For the \texttt{FLEUR-MaX} release, in the \ref{tag:KFILE}, you have to specify total number of segments (intersections) along the whole k-path. In this case, one can set \ref{tag:KFILE} as follows:
    
     \begin{verbatim}
     KFILE KPOINTS_BAND  FLEURMaX
     \end{verbatim}
         \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= KPOINTS\_BAND $line$ $mode$ example with FLEURMaX tag, 
            labelposition=bottomline]
     k-points line mode example
       100  ! intersections
     Line-mode
     Reciprocal
       0.50000000  0.5000000 0 M
       0.33333333  0.6666666 0 K
       
       0.33333333  0.6666666 0 K
       0.00000000  0.0000000 0 G
       
       0.00000000  0.0000000 0 G
       0.66666666  0.3333333 0 K'
        \end{Verbatim}

	One can also try following input. You can also specify explicitly how many divisions in between special K-points. Total number of k-points will be (7+18+19+19)+1(last point)

         \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= KPOINTS\_BAND $line$ $mode$ example with FLEURMaX tag, 
            labelposition=bottomline]
     k-points line mode example
       7 18 19 19  ! 64 intersections and evenly devided k-segment
     Line-mode
     Reciprocal
       0.000  0.000 0.000 G
       0.500  0.500 0.500 Z

       0.500  0.500 0.500 Z
       0.500  0.500 0.000 F
       
       0.500  0.500 0.000 F              
       0.000  0.000 0.000 G1
       
       0.000  0.000 0.000 G1
       0.500  0.000 0.000 L
        \end{Verbatim}

        Note2: If your target band structure is originated from \href{https://aimsclub.fhi-berlin.mpg.de}{\texttt{FHI-aims}}, 
        the division between each $k$-path can be specified separately. For example, the typical way to specify band structure calculation tag
        in \href{https://aimsclub.fhi-berlin.mpg.de}{\texttt{FHI-aims}} looks as follows:
        
     \begin{verbatim}
     output band 0.00  0.00  0.00    0.50  0.00  0.00  70   G  X
     output band 0.50  0.00  0.00    0.50  0.50  0.00  20   X  M
     output band 0.50  0.50  0.00    0.00  0.50  0.00. 70   M  Y
     \end{verbatim}
     
     Here, each $k$-path is divided with 70, 20, and 70 divisions.
     In this case, you can specify each numbers (70 20 70) to your second line of  \ref{tag:KFILE}.

        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= KPOINTS\_BAND $line$ $mode$ (FHI-aims type), 
            labelposition=bottomline]
     k-points line mode example
       70 20 70  ! intersections
     Line-mode
     Reciprocal
       0.0  0.0 0.0 G
       0.5  0.0 0.0 X
       
       0.5  0.0 0.0 X
       0.5  0.5 0.0 M

       0.5  0.5 0.0 M
       0.0  0.5 0.0 Y
        \end{Verbatim}        

  	
  	\item[\namedlabel{tag:KREDUCE}{KREDUCE}] $integer$ Default: \texttt{1} \index{KREDUCE} \\
		For some cases, the target \ref{tag:EFILE} contains too many $k$-points with 
		larger $n$ of divisions between each line segment. In this case, 
		you can reduce the number of $k$-points to be read by skipping $k$-points except every $nk_{reduce}$. 
	
		For example, if it has been divided with 10 $k$-points between each symmetry points in your \ref{tag:EFILE}, you can reduce by factor of 2 or 5 by specifying 
     \begin{verbatim}
     KREDUCE    2
     or
     KREDUCE    5 .
     \end{verbatim}
	  In this case, if \ref{tag:KREDUCE} is 2, then the total number of divisions will
	  become 5, and this value should be same as number of $k$-point division 
	  which is specified in second line of your \ref{tag:KFILE}. 
	  Note that \texttt{KREDUCE} should be one of prime number of the 
	  $k$-point division of \ref{tag:EFILE}. 
	  
    \item[\namedlabel{tag:LOCCHG}{LOCCHG}] $logical$ Default: \texttt{.FALSE.} \index{LOCCHG}\\
        Setting tag for local potential.
        If \texttt{.TRUE.}, one should give proper local potential parameter 
		in your \ref{tag:PFILE} and should properly setup \ref{tag:param-locpot} \ref{tag:param-locpot} 
		tag in your \ref{tag:GFILE}. For the details, see the explanation of
		\ref{tag:param-locpot} in Sec.\ref{tag:PFILE-detail}.

    \item[\namedlabel{tag:TYPMAG}{TYPMAG}] $string$ Default: \texttt{NONMAG} \index{NONMAG}\\
        Setting tag for magnetic moment: \texttt{nonmagnetic}, \texttt{collinear}, 
		\texttt{noncollinear}
		If \texttt{collinear} and \texttt{noncollinear} tag is applied, 
		\ref{tag:MOMENT} or \ref{tag:MOMENT.C} in the \ref{tag:GFILE}
		should be set up appropriately.
		For details, see \ref{tag:MOMENT} of the Sec.\ref{tag:GFILE-detail}.

    \item[\namedlabel{tag:LSORB}{LSORB}] $logical$ Default: \texttt{.FALSE.} \index{LSORB}\\
        Setting tag for spin-orbit coupling. 
		If \texttt{.TRUE.}, $lambda\_orb\_spec$ should be properly defined in the
		\ref{tag:PFILE}. For details, see Sec.\ref{tag:PFILE-detail}

    \item[\namedlabel{tag:LORBIT}{LORBIT}] $logical$,$string (optional)$,$string (optional)$ Default: \texttt{.TRUE.} \index{LORBIT}\\
        Setting tag for orbital decomposed output.
		If \texttt{.TRUE.} the local orbital contribution will be printed out
		in \texttt{bandstructure\_TBA.dat} file.
        If you write \texttt{rh} or \texttt{mx} or \texttt{my} or \texttt{mz} next to the logical text with \texttt{.TRUE.},
        then, corresponding magnetization values, which represents
        the expectation value of pauli matrices $\sigma_{i}$ where i=$\{$0,1,2,3$\}$, 
        will be printed out. Here $\sigma_{0}$ is 2$\times$2 identity 
        matrix to print out local orbital contribution. For example,   
        
    \begin{verbatim}
     LORBIT .TRUE. mz
    \end{verbatim}
    will print out $<$\texttt{mz}$>$.
        If you write \texttt{re} or \texttt{im} next to the logical text with \texttt{.TRUE.}, then, \texttt{real} or \texttt{imaginary} part of the wavefunction coefficient will be printed out. Note that this option only applicable with \texttt{LSORB .FALSE.} in the current version.
    \begin{verbatim}
     LORBIT .TRUE. re
    \end{verbatim}
        If you write \texttt{wf} next to the logical text with \texttt{.TRUE.}, then, the wavefunction coefficient will be printed out. The real and imaginary part for 
        each orbital basis is written. If \texttt{LSORB .TRUE.},
        the spinor-up and spinor-dn part will be written, so that four real values will construct wavefunction coefficient. 
    \begin{verbatim}
     LORBIT .TRUE. wf
    \end{verbatim}

        Note that the corresponding output file \texttt{bandstructure\_TBA.dat} file will be basically 
        written by ascii (formatted) format. If you want to write in binary (unformatted) format,
        specify by \texttt{bin} (complex*16; double precision) or \texttt{bin4} (complex*8; single precision) tag next\footnote{In the current version, \texttt{bin} or \texttt{bin4} tag is only applicable when it is combined with \texttt{wf} option}. For example,

    \begin{verbatim}
     LORBIT .TRUE. wf bin
     or
     LORBIT .TRUE. wf bin4
    \end{verbatim}
    
        This tag will generate \texttt{band\_structure\_TBA.(up/dn).}\textblue{bin} file.
        
    \item[\namedlabel{tag:PROJBAND}{PROJ\_BAND}] $logical, integers$ Default: \texttt{.FALSE.} \index{PROJ\_BAND}\\
		Setting tag for orbital/atom projected band structure output. The output will be written in separate file for each atom. The correct usage is as follows: 
    \begin{verbatim}
     PROJ_BAND .TRUE. 1:4 7
    \end{verbatim}
    then you can get \texttt{band\_structure\_atom.\#.dat} file \\
    
        \begin{verbatim}
     band_structure_atom.1.dat
     band_structure_atom.2.dat
     band_structure_atom.3.dat
     band_structure_atom.4.dat
     band_structure_atom.7.dat
    \end{verbatim} 
    and additionally, \texttt{band\_structure\_atom.sum1.dat}     
    file will be printed out as well, where projected local DOS for those atoms (\{1,2,3,4,7\}) are summed up in a single file.
    
    If you write another \texttt{PROJ\_BAND} tag specifying different atom sets in the separate line,
    for example, 
    
    \begin{verbatim}
     PROJ_BAND .TRUE. 1:4 7
     PROJ_BAND .TRUE. 5:8
    \end{verbatim}
    
    then, you can get another set of files (\texttt{band\_structure\_atom.sum2.dat} and \\
    \texttt{band\_structure\_atom.\{5..8\}.dat}) as follows:
    \begin{verbatim}
     band_structure_atom.1.dat
     band_structure_atom.2.dat
     band_structure_atom.3.dat
     band_structure_atom.4.dat
     band_structure_atom.5.dat
     band_structure_atom.6.dat
     band_structure_atom.7.dat
     band_structure_atom.8.dat
     band_structure_atom.sum1.dat  (= 1+2+3+4+7) 
     band_structure_atom.sum2.dat  (= 5+6+7+8)
    \end{verbatim} 
       
    Note1: The atom index should be written in ascending order
    and should not exceed total number of atoms of your system. \\
    Note2: Since in the \texttt{band\_structure\_atom.sum?.dat} file 
    the projected local DOS for each orbital basis of the specified atoms are 
    summed up, one should make sure that the specified atoms should have same orbital basis set. For instance, let's assume that you have atoms $A$=\{1:4, 7\} with orbitals $p_x, p_y, p_z$, and atoms $B$=\{5:8\} with orbitals $s, p_x, p_y, p_z$. Then it will works fine with "\texttt{PROJ$\_$BAND .TRUE. 1:4 7}" tag, but not works fine with 
        "\texttt{PROJ$\_$BAND .TRUE. 1:4 5:8}".
     
    \item[\namedlabel{tag:PROSUM}{PROJ\_SUM}] $logical, integers$ Default: \texttt{.FALSE.} \index{PROJ\_SUM}\\
		This tag has same functionality as \ref{tag:PROJBAND}. The syntax is same as  \ref{tag:PROJBAND}, but here the atom projection will not be written. That is, there will be no output such as \texttt{band\_structure\_atom.?.dat} files. But still, summation over the specified atoms would be written  in \texttt{band\_structure\_atom.sum?.dat} files. This functional would be useful if someone does not want to save all the atomic information but only the integrated information is needed.
      
     \item[\namedlabel{tag:CIRC}{CIRC\_DICHROISM}] $logical, integer, integer$ Default: \texttt{.FALSE.} \index{CIRC\_DICHROISM}\\  
		Calculate ${\vec k}$-resolved degree of polarization by circularly polarized light. Here, we compute the circular dichroism $\eta_{mn}({\vec k})$, which demonstrate the optical chiral selection rule from state $m$ to $n$ of ${\vec k}$-point, using\footnote{W. Yao, D. Xiao, and Q. Niu, ``Valley-dependent optoelectronics from inversion symmetry breaking" $Physical$ $Review$ $B$  \texttt{77}, 235406 (2008)}
				$\eta_{mn}({\vec k}) = \frac{|\mathcal{P}^{nm}_+({\vec k})|^2 - |\mathcal{P}^{nm}_-({\vec k})|^2}{|\mathcal{P}^{nm}_+({\vec k})|^2 + |\mathcal{P}^{nm}_-({\vec k})|^2}$. 
				The matrix element $\mathcal{P}^{nm}_{\pm}({\vec k}) = \langle \psi_n({\vec k})|  \mathcal{P}_{\pm}({\vec k}) |\psi_m({\vec k}) \rangle$ determines the $\sigma_+$ and $\sigma_-$ light adsorption, respectively, between band index $n$ and $m$. 
				Here, the interband matrix element $\mathcal{P}_{\pm}({\vec k})$ is given by 
				$\mathcal{P}_{\pm}({\vec k}) = \mathcal{P}_x({\vec k}) + i \mathcal{P}_y({\vec k})$, where $\mathcal{P}_\alpha({\vec k})$ is the canonical momentum operator $(e/\hbar) \partial \hat{H}_{\vec k} / \partial k_\alpha$.
				The usage is as follows:
	
    \begin{verbatim}
     CIRC_DICHROISM .TRUE. 18 19   # from band m=18 to n=19
     CIRC_DICHROISM .TRUE. 18 20   # from band 18 to 20
     ...
    \end{verbatim}
						The results will be printed out in \texttt{CIRC\_DICHROISM.EIG\_$m$-$n$.dat}.
		
		NOTE: this tag is only valid with orthogonal basis with \texttt{\ref{tag:OVERLAP} = .FALSE.} in \ref{tag:PFILE}.

    \item[\namedlabel{tag:LOADHOP}{LOAD\_HOP}] $logical$, $string$ Default: \texttt{.false.} \index{LOAD\_HOP}\\
		If \texttt{.true.}, one can load \texttt{hopping} file to read $t_{ij}$ value. The following $string$ should be the file name to be read. And the syntax of the file should be exactly same as the \texttt{hopping.dat} file, which is generated in the initial stages of the calculation.
		Hence, if you have pre-generated \texttt{hopping.dat} file (with \texttt{LOAD\_HOP .FALSE.}), you can copy it with a different name and modify the elements of $t_{ij}$ column, and rerun the code with following tag (for example, if you have copied \texttt{hopping.dat} $\rightarrow$ \texttt{hopping\_modified.dat}):
		
    \begin{verbatim}
     LOAD_HOP  .TRUE.   hopping_modified.dat
    \end{verbatim}

		Below, you can see that the original hopping element can be modified by changing values of the \textblue{t\_IJ(eV)} column.  
        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= hopping.dat example file, 
            labelposition=bottomline]
     # Iatom Jatom     Rij      ... ORB_I ... ORB_J ...  \textblue{t_IJ(eV)}  ... 
         1     1   0.0  0.0 0.0 ...   s   ...   s   ...   \textred{-4.0}     ... 
         1     1   0.0  0.0 0.0 ...   s   ...   px  ...    0.0     ... 
         1     1  -1.2 -0.7 0.0 ...   s   ...   s   ...   -3.9     ... 
         1     2  -1.2 -0.7 0.0 ...   s   ...   px  ...    1.9     ... 
         ...
         ...
        \end{Verbatim}

        \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
            label= hopping\_modified.dat example file, 
            labelposition=bottomline]
     # Iatom Jatom     Rij      ... ORB_I ... ORB_J ...  \textblue{t_IJ(eV)}  ... 
         1     1   0.0  0.0 0.0 ...   s   ...   s   ...   \textred{-2.0}     ... 
         1     1   0.0  0.0 0.0 ...   s   ...   px  ...    0.0     ... 
         1     1  -1.2 -0.7 0.0 ...   s   ...   s   ...   -3.9     ... 
         1     2  -1.2 -0.7 0.0 ...   s   ...   px  ...    1.9     ... 
         ...
         ...
        \end{Verbatim}


    \item[\namedlabel{tag:IBAND}{IBAND}] $integer$ Default: \texttt{1} ($deprecated$) \index{IBAND}\\
		\texttt{IBAND} is the first eigenstate of the target data of 
		\ref{tag:EFILE}. This value will be used in the \ref{tag:WEIGHT}
		\texttt{SET} section.

    \item[\namedlabel{tag:FBAND}{FBAND}] $integer$ Default: \texttt{NEIG} ($deprecated$) \index{FBAND}\\
		\texttt{NEIG} : number of orbital basis of the system.
		\texttt{FBAND} is the last eigenstate of the target data of 
		\ref{tag:EFILE}. This value will be used in the \ref{tag:WEIGHT}
		\texttt{SET} section.

    \item[\namedlabel{tag:SCISSOR}{SCISSOR}] $integer, real$ \index{SCISSOR}\\
		If set, in the fitting procedures, target energy \texttt{EDFT($n$,$k$)}
		will be shift by amound of the scissor operation. 
		This operation works as follows: E$_{target}'(n,k)$ = 
		E$_{target}$($n$,$k$) + $e_{scissor}$ if $n$ $>$= i$_{scissor}$.
		Note that this operation is only valied if \ref{tag:TBFIT} is \texttt{.TRUE.}. 
    \begin{verbatim}
     SCISSOR 29 0.2  # i_scissor = 29 and e_scissor = 0.2 (eV)
    \end{verbatim}

	\item[\namedlabel{tag:NNMAX}{NN\_MAX}] $integer$ Default: 3 \index{NN\_MAX}\\
        Determine how many times the cell will be repeated in searching hopping pairs. 
        If your system is sufficiently larger than the maximal value of hopping
        distances of your system, this can be reduced to 1, otherwise just use default value.
	\begin{verbatim}
		NN_MAX 3 3 3 
	\end{verbatim}
		or
		
	\begin{verbatim}
		NN_MAX 3 
	\end{verbatim}
	
		both settings will give 3$\times$3$\times$3 cell repeat.
		
    \item[\namedlabel{tag:ERANGE}{ERANGE}] $integer$ Default: \texttt{1 NEIG} \index{ERANGE} \\
		If provided, the energy level between these energy window will be printed
		out in the \texttt{bandstructure\_TBA.dat} file. 
    \begin{verbatim}
     ERANGE  4400 4700  
    \end{verbatim}
		Above example means that the energy level from 4400$^{th}$ to 
		4700$^{th}$ will be printed. 
		This is particularly useful if you calculate very large
		systems. By setting \texttt{ERANGE} tag, you can save disk space
		a lot if \ref{tag:LORBIT} tag is turned on where orbital component
		information takes huge memory for larger systems.

    \item[\namedlabel{tag:EWINDOW}{EWINDOW}] $real$, $integer$ Default: not activated \index{EWINDOW}\\
    The eigenvalues within the energy window [emin:emax] will be calculated and stored. This option also useful in dealing with huge system. The usage for this tag is as follows:
    
    \begin{verbatim}
     EWINDOW  -5.0:5.0   NE_MAX 10  
    \end{verbatim}

		If provided, the energy level between these energy window will be printed
		out in the \texttt{bandstructure\_TBA.dat} file. 

		In the above setting, the eigenvalue ($\{e\}$) within the energy window [-5.0:5.0] will be calculated and stored. The \texttt{NE\_MAX} represents the maximum number of eigenvalue to be searched within the window and usually should be larger than the number of actual eigenvalues (\texttt{NE}) within the range and should not exceed the total number of eigenvalue (\texttt{NE\_TOT}) of the system. The optimal values for \texttt{NE\_MAX} is about 1.5$\times$\texttt{NE}\footnote{Eric Polizzi, ``Density-matrix-based algorithm for solving eigenvalue problem" $Physical$ $Review$ $B$  \texttt{79}, 115112 (2009)}. Since the \texttt{NE\_MAX} is critical to the calculation speed, choosing the optimal values is essential. During the calculation, the program will find the optimal \texttt{NE\_MAX} and update in every k-point loop.\footnote{Though, one need to provide reasonable \texttt{NE\_MAX} to save the memory, since \texttt{NE\_MAX} is used to reserve memory space for the eigenvector store internally.}\\
		
      Note 1: If the tag is specified in your input file, the Hamiltonian matrix will be constructed with the sparse matrix format rather than dense matrix format. The libraries to dealing with the sparse matrix is referred from \texttt{Intel Math Kernel Library (MKL)}, please make sure that your library path is properly assigned. (suggest to use \texttt{MKL} version $\geq$ 11.3) \\
      
      Note 2: If \texttt{NE\_MAX} is not provided or exceeding \texttt{NE\_TOT}, i.e., \texttt{NE\_MAX}$\geq$\texttt{NE\_TOT}, \texttt{NE\_MAX} will be set to \texttt{NE\_TOT} by default. 
      
    \item[\namedlabel{tag:PRTSEPK}{PRTSEPK}] $logical$ Default: \texttt{.FALSE.} \index{PRTSEPK}\\
		If \texttt{.TRUE.}, band structure file, \texttt{band\_structure\_TBA.dat}, will 
		be separated for each $k$-point, i.e., \texttt{band\_structure\_TBA.kp\_1.dat}, \texttt{band\_structure\_TBA.kp\_2.dat}, ..., etc. This tag is useful if you are dealing with very large system and many $k$-points, where due to the the memory problem, calculation get failed to be finished.

    \item[\namedlabel{tag:LDISTRK}{LDISTRK}] $logical$ Default: \texttt{.FALSE.} \index{LDISTRK}\\
		If \texttt{.TRUE.}, eigenvector information is distributed over the cpus in parallel version.
		This is to prevent memory problem in the large system calculations. 
		This functional is only valid if number of cpu process is more than 1.\\
		NOTE: This functional should not be used in the current version. It's on the developing stages.


    \item[\namedlabel{tag:PRTHAMK}{PRTHAMK}] $logical$ Default: \texttt{.FALSE.} \index{PRTHAMK}\\
		If \texttt{.TRUE.}, hamiltonian matrix $H_k$ will be written for each $k$-point into separate file \texttt{Matrix.Hk\_K$ik$\_SP$is$.dat}, where $ik$ and $is$ represents $k$-point and spin index, respectively. If \ref{tag:OVERLAP} is set to \texttt{.TRUE.} in your \ref{tag:PFILE}, overlap matrix $S_k$ also will be wrtten for each $k$-point into separate file \texttt{Matrix.Sk\_K$ik$\_SP$is$.dat}.

    \item[\namedlabel{tag:LORDER}{LORDER}] $logical$ Default: \texttt{.FALSE.} \index{LORDER} \\
		If \texttt{.TRUE.}, band structure will be re-ordered
        by maximizing the overlap between neighboring k-points. The overlap can be defined by the inner product of the wavefunctions $\langle u_{n,k} | u_{m,k-1} \rangle$. 
        The re-ordered band structure will be written in \texttt{band\_structure\_ordered.dat} file.
        If \texttt{OV\_CUT} tag is also provided with $real$ value, the cutoff for the overlap integral to be considered with the value. The bands above \texttt{OV\_CUT} will be swapped. The default value is $\frac{\sqrt{2}}{2}$. 
           
      \begin{verbatim}
     LORDER .TRUE. OV_CUT 0.7  
     \end{verbatim}
     
     NOTE: (important) If the LORDER = .TRUE. with TBFIT = .TRUE., then the fitting will be done with re-ordered band structure. Therefore, re-ordered target energy information should be provided in parallel with the original energy  in ~\ref{tag:EFILE}. Please check \ref{tag:EFILE} tag, for the instruction how to provide re-ordered energy in this case. To get re-ordered energy: for \href{https://www.vasp.at}{\texttt{VASP}}, one can use \href{https://github.com/QijingZheng/VaspBandUnfolding}{\texttt{VaspBandUnfolding}} tools for re-ordering: for \href{https://www.quantum-espresso.org}{\texttt{QE}}, one can use \href{https://www.quantum-espresso.org/Doc/INPUT_BANDS.html}{\texttt{bands.x}} postprocessing program. 
     	In this case, \ref{tag:WEIGHT} tag should be carefully adjusted according to the re-ordered band index.
        

    \item[\namedlabel{tag:LPHASE}{LPHASE}] $logical$ Default: \texttt{.TRUE.} \index{LPHASE}\\
		If \texttt{.TRUE.}, we construct Bloch basis functions 
		$\chi_i^{\vec k}({\vec r}) = \sum_{\vec R} e^{i {\vec k}\cdot ({\vec R + \vec t_i})} \phi_i({\vec r - \vec R})$. \\
		If \texttt{.FALSE.}, the phase factor $e^{i {\vec k \cdot \vec t_j}}$ is not included in the definition of Bloch functions. 

    \item[\namedlabel{tag:LTOTEN}{LTOTEN}] $logical$ Default: \texttt{.FALSE.} \index{LTOTEN}\\
		If \texttt{.TRUE.}, calculate total energy $E_{TOT} = E_{band}$, where $E_{band} = \sum_{n,k} f_{n,k} e_{n,k}$. Here, $f_{n,k}$ and $e_{n,k}$ is the Fermi-Dirac occupation function and eigen value of $n$-th level of $k$-th ${\vec{k}}$-point, respectively. \\
        To calculate Fermi level, one should provide number of electrons and 
        electronic temperature by \ref{tag:NELECT} and \ref{tag:ELTEMP} tag.
    
    \item[\namedlabel{tag:NELECT}{NELECT}] $real$ Default: \texttt{not specified} \index{NELECT}\\
        Total number of electrons of the tight binding models. In the collinear calculaltions, i.e., \ref{tag:TYPMAG} is $collinear$, both spin-up and spin-down components should be specified together as follows:
        \begin{verbatim}
            NELECT  10   10   # for spin-up and spin-dn
        \end{verbatim}
    
    \item[\namedlabel{tag:ELTEMP}{ELTEMP}] $real$ Default: \texttt{0.001/$k_B$ $\sim$ 11.6045 K} \index{ELTEMP}\\
        Electronic temperature T ($K$), which will be used in Fermi-Dirac distribution 
        function $f(T)=\frac{1}{1+\exp{(e - \mu)/k_BT}}$ to obtain Fermi level, where $e$ is energy level (in $eV$), $\mu$ is Fermi level (in $eV$), and $k_B$ is Boltzman constant.
    
    \item[\namedlabel{tag:ISEED}{ISEED}] $integer$ Default: 123 \index{ISEED}\\
       	Random seed used in \ref{tag:GA}, \ref{tag:PSO} method. 
       	It should be larger than zero and any integer value is accepted. The random number generator is used to introduce random noise to the tight-binding
       	parameters.
    
       
    \item[\namedlabel{tag:SET}{SET}] $string$ \index{SET}\\
        Setting tags for post processing, parameter constraints,
		and nearest neighbor setups, etc.
		Available list for the \texttt{SET} tags are as follows,
	\subitem \ref{tag:GA} : for Genetic Algorithm setting
 	\subitem \ref{tag:CONSTRAINT}
 	\subitem \ref{tag:NNCLASS}
 	\subitem \ref{tag:RIBBON}
 	\subitem \ref{tag:BERRYC}
 	\subitem \ref{tag:ZAKPHASE}
 	\subitem \ref{tag:WCC}
 	\subitem \ref{tag:Z2}
  	\subitem \ref{tag:PARITY}	
 	\subitem \ref{tag:EFIELD}
 	\subitem \ref{tag:WEIGHT}
 	\subitem \ref{tag:DOS}
 	\subitem \ref{tag:EIGPLOT}
 	\subitem \ref{tag:STMPLOT}
 	\subitem \ref{tag:EFFECTIVE}
 	\subitem \ref{tag:REPLOT}

\end{description}


\newpage

\section{Details of the \texttt{SET}}\label{tag:SET-detail}
Each \texttt{SET} tag should be ended up by \texttt{END} tag.

\begin{description}
	\item[\namedlabel{tag:SET_GA}{GA}] \index{SET!GA}
		Setting of control parameters for the \texttt{Genetic Algorithm} used in parameter fitting procedures. This setting is only effective when \ref{tag:LSTYPE} is set to \texttt{GA}. Below you can check the default settings for GA procedures. You can modify as your purpose or comment out to use default setup as a input.
 
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= GA default setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}GA
      \textgreen{MGEN} 100 # maximum number of iterations. (default:500) \index{SET!GA!MGEN}
      \textgreen{NPOP} 100 # population in each generation. (default:100) \index{SET!GA!NPOP}
      \textgreen{NGENE} 6  # number of genes in chromosomal encoding. \index{SET!GA!NGENE}
               # should be in between 2 to 9. (default:6)
      \textgreen{PCROSS} 0.85 # crossover probability. [min:max]=[0.0:1.0] \index{SET!GA!PCROSS}
      \textgreen{RMUTMIN} 0.0005 # minimum mutation rate. [0.0:1.0] \index{SET!GA!RMUTMIN}
      \textgreen{RMUTMAX} 0.25   # maximum mutation rate. [0.0:1.0] \index{SET!GA!RMUTMAX}
      \textgreen{RMUTINI} 0.005  # initial mutation rate. [0.0:1.0] \index{SET!GA!RMUTINI}
      \textgreen{MUT_MOD} 2      # mutation with 1: fixed rage \index{SET!GA!MUT\_MOD}
                     # mutation       with 2: fitness dependent
                     # mutation       with 3: distance dependent
                     # mutation+creep with 4: fixed rate
                     # mutation+creep with 5: fitness dependent
                     # mutation+creep with 6: distance dependent
      \textgreen{FDIF} 1.0      # relative fitness differential [0.0:1.0] \index{SET!GA!FDIF}
      \textgreen{IREP} 3   # reproduction plan 1: Full generational replacement \index{SET!GA!IREP}
               #                   2: Steady-state-replace-random
               #                   3: Steady-state-replace-worst
      \textgreen{IELITE} 0   # elitism 0: off, 1: on  \index{SET!GA!IELITE}
                 # Note that this tag applies only if IREP=1 or 2.
      \textgreen{VERBOSE} 1  # printed output 0/1/2=None/Minimal/Verbose \index{SET!GA!VERBOSE}
      \textgreen{CONVTOL} 0.0001 # convergence tolerance (must be > 0.0). \index{SET!GA!CONVTOL}
      \textgreen{CONVWIN} 20 # convergence window.  \index{SET!GA!CONVWIN}
                 # If \texttt{CONVWIN} consecutive solutions are found 
                 # convergence will be declaired. 
                 # Hence, give larger convergence window to reach minima.
      \textgreen{IGUESSF} 0.1 # fraction of the initial population to set equal \index{SET!GA!IGUESSF}
                  #to the initial guess. [0.0:1.0]
    \color{blue}END \color{red}GA
 \end{Verbatim}
%      \textgreen{ISEED} 999 # random seed value (must be > 0).  \index{SET!GA!ISEED}
	
	
    \item[\namedlabel{tag:STMPLOT}{STMPLOT}] \index{SET!STM}
        Setting of integrated eigen state wavefunction $\Sigma |\psi_{nk}(r)|^{2}$ plot.
		Here, the summation runs over the eigen states within the energy window specified
		by \texttt{STM\_ERANGE} or equivalently \texttt{STM\_WINDOW}.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= STMPLOT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}STMPLOT
      \textgreen{NGRID} 40 40 80 # GRID for CHGCAR-STM output (default = 0.1 ang). \index{SET!STM!NGRID}
      \textgreen{STM\_ERANGE} -1.0:0.0  # energy window \index{SET!STM!STM\_ERANGE}
      \textgreen{RCUT} 6.0 # cut off radius(\AA). Beyond this will not be calculated. \index{SET!STM!RCUT}
      \textgreen{REPEAT_CELL} T T T  # repeat orbital for each lattice vector? \index{SET!STM!REPEAT\_CELL}
         # this logical tag is especially useful if you only 
         #consider center region of the very large cell.
         # If set "T T F", orbital contribution which is periodically 
         # repeated in a3 direction wll not be considered to calculate. 
         # Try this option if  you have very large cell and you are 
         # especially interested unitcell ceter.
    \color{blue}END \color{red}STMPLOT
 \end{Verbatim}

    \item[\namedlabel{tag:EIGPLOT}{EIGPLOT}] \index{SET!EIGPLOT}
        Setting of eigen state wavefunction $\psi_{nk}(r)$ or 
		charge density $|\psi_{nk}(r)|^{2}$ plot.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= EIGPLOT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}EIGPLOT
      \textgreen{IEIG} 3 5   # index(es) n of eigen state. \index{SET!EIGPLOT!IEIG}
      \textgreen{IKPT} 1 10  # index(es) k of k-point. \index{SET!EIGPLOT!IKPT}
      \textgreen{NGRID} 40 40 80 # GRID for CHGCAR output (default = 0.1 ang). \index{SET!EIGPLOT!NGRID}
      \textgreen{RORIGIN} 0.0 0.0 0.0 # shift of the origin of the cube file. \index{SET!EIGPLOT!RORIGIN}
      \textgreen{WAVEPLOT} .TRUE. # plot wavefunction (.true.) or charge density. \index{SET!EIGPLOT!WAVEPLOT}
      \textgreen{RCUT} 6.0 # cut off radius(\AA). Beyond this will not be calculated. \index{SET!EIGPLOT!RCUT}
    \color{blue}END \color{red}EIGPLOT
 \end{Verbatim}


    \item[\namedlabel{tag:DOS}{DOS}] \index{SET!DOS}
        Setting of \texttt{Density of states (DOS)}.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= DOS setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}DOS
      \textgreen{GKGRID} 100 100 1   # set Gamma centered Monkhorst-Pack grid \index{SET!DOS!GKGRID}
      \textgreen{KSHIFT} 0.0 0.0 0.0 # shift of k-grid (k-offset) \index{SET!DOS!KSHIFT}
      \textgreen{PRINT_KPTS} .TRUE. IBZKPT-DOS_TB # print k-point to the file \index{SET!DOS!PRINT\_KPTS}
      \textgreen{PRINT_EIG} .TRUE. 1:2 3 # print specified energy surface \index{SET!DOS!PRINT\_EIG}
      \textgreen{PRINT_UNIT} RECIPROCAL # k-point unit (or ANGSTROM 1/A) \index{SET!DOS!PRINT\_UNIT}
      \textgreen{SMEARING} 0.03 # gaussian smearing. Default = 0.025 \index{SET!DOS!SMEARING}
      \textgreen{NEDOS} 2000    # number of grid points in energy window (erange) \index{SET!DOS!NEDOS}
      \textgreen{DOS_EWINDOW} -20.0:10.0 # energy window to be plotted \index{SET!DOS!DOS\_EWINDOW}
      \textgreen{DOS_NRANGE} 1:NEIG # energy window to be calculated (integer) \index{SET!DOS!DOS\_NRANGE}
      \textgreen{DOS_SPARSE} .TRUE. # or .FALSE. use sparse matrix? Default=.FALSE. \index{SET!DOS!DOS\_SPARSE}
      \textgreen{DOS_FNAME} DOS_TB_projected.dat # output file name for DOS output \index{SET!DOS!DOS\_FNAME}
      \textgreen{PRINT_LDOS} .TRUE. 1:8 12 # Print local density of states for given\\
                             # atoms. Here, 1 to 8-th atoms and 12-th \\
                             # atoms will be resolved.
      \textgreen{LDOS_FNAME} LDOS_TB_projected  # header for LDOS file name. \\
                             # atom index will be appended after.   
                             # For example, for atom-1, \\
                             # LDOS_TB_projected_atom.1.dat file will \\
                             # be generated.       
    \color{blue}END \color{red}DOS
 \end{Verbatim}
Note1: \texttt{NEIG} variable of the \texttt{DOS\_NRANGE} tag indicates
total number of states, i.e., \texttt{N\_ORB}$\times$\texttt{ISPINOR}, 
where \texttt{N\_ORB} is total number of atomic orbitals and 
\texttt{ISPINOR} = 1 (\ref{tag:LSORB} = .FALSE.) or 2 (\ref{tag:LSORB} = .TRUE.).
If you want to reduce calculation loads, you can adjust \texttt{DOS\_NRANGE}. \\
Note2: \texttt{DOS\_SPARSE} tag is only available if 
    \textblue{-DMKL\_SPARSE} option is activated in the \texttt{makefile}. 
    If set to \texttt{.TRUE.}, \texttt{DOS\_NRANGE}
    should be as following:
     \begin{verbatim}
       DOS_NRANGE  1:NE_MAX
       or
       DOS_NRANGE  NE_MAX
     \end{verbatim}
     Here, \texttt{NE\_MAX} is integer value larger
     than zero and less equal than total number of 
     states NEIG.
    This setting will reduce the resources
    required for hamiltonian matrix construction
    and time consuming for the eigenvalue problem
    by the energy window constraint in the help
    of sparse matrix eigen solver. 
    See \ref{tag:EWINDOW} for more informations. \\
Note3: \texttt{PRINT\_EIG} is only applicable if 
    \texttt{DOS\_SPARSE} = .FALSE.

    \item[\namedlabel{tag:EFIELD}{EFIELD}]
        Setting of \texttt{E-field}.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= EFIELD setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}EFIELD
      \textgreen{EFIELD}  0.0 0.0 0.1  # Efield along z direction
      \textgreen{EF\_ORIGIN}  0.0 0.0 0.345690593  # (in fractional coordinate)
     #\textgreen{EF\_CORIGIN} 0 0 0  # (in cartesian coordinate)
    \color{blue}END \color{red}EFIELD
 \end{Verbatim}


    \item[\namedlabel{tag:WEIGHT}{WEIGHT}] 
		Setting of weight factor for the fitting procedures.
		\subitem KRANGE $integer$ : range of k-point where the weight factor is applied \index{SET!WEIGHT!KRANGE}
		\subitem TBABND $integer$ : range of eigen states of the tight binding calculation \index{SET!WEIGHT!TBABND}
		\subitem DFTBND $integer$ : range of eigen states of the target energy bands \index{SET!WEIGHT!DFTBND}
		\subitem WEIGHT $real$ : weighting factor \index{SET!WEIGHT!WEIGHT}
		\subitem ORBT\_I $ineteger$ : orbital index. $n^{th}$ orbital states will get a penalty \index{SET!WEIGHT!ORB\_I}
		\subitem SITE\_I $ineteger$ : site index. \texttt{ORBT\_I}$^{th}$  orbital state  \index{SET!WEIGHT!SITE\_I}
		at \texttt{SITE\_I} atom will get a penalty. This prohibit certain orbital character 
		to be stabilized from the fitting procedures.
		


 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= WEIGHT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}WEIGHT
      \textgreen{IBAND} = 1    # alias for initial band index
      \textgreen{FBAND} = 20   # alias for final band index
      \textgreen{VBMT}  = 17   # alias for valence band maximum of TB band
      \textgreen{CBMT}  = 20   # alias for conduction band minimum of TB band
      \textgreen{VBMD}  = 17   # alias for conduction band minimum of DFT band
      \textgreen{CBMD}  = 20   # alias for conduction band minimum of DFT band
      \textgreen{KRANGE}  :        \textgreen{TBABND}  :          \textgreen{DFTBND} IBAND:FBAND \textgreen{WEIGHT} 1
      \textgreen{KRANGE}  :        \textgreen{TBABND} VBMT:CBMT   \textgreen{DFTBND} VBMD:CBMT   \textgreen{WEIGHT} 6 
      \textgreen{KRANGE} 20:60 X:M \textgreen{TBABND} VBMT-2:CBMT \textgreen{DFTBND} VBMD-2:CBMT \textgreen{WEIGHT} 20
      \textgreen{KRANGE} 20:60     \textgreen{TBABND} 2:4         \textgreen{DFTBND} 2:4         \textgreen{WEIGHT} 50
      \textgreen{KRANGE} 1     \textgreen{TBABND}  7    \textgreen{ORBT\_I} 1  \textgreen{SITE\_I} Mo1 \textgreen{PENALTY} 200
    \color{blue}END \color{red}WEIGHT
 \end{Verbatim}

 \texttt{Note 1:} After fitting procedure is over, the \ref{tag:WEIGHT} information is 
 written in \ref{tag:PFILE} so that one can restart fitting. To use \ref{tag:WEIGHT} information written in \ref{tag:PFILE}, one can add \texttt{USE\_WEIGHT} tag in your \ref{tag:PFILE} tag. Please find this information in \ref{tag:PFILE} tag. \\
 \texttt{Note 2:} The $k$-point name also can be used to specify \texttt{KRANGE}. Above example show that one can set weight factor by specifying     \texttt{X:M} which indicates the range from \texttt{X} point to \texttt{M} point. The $k$-point name can be defined in \ref{tag:KFILE}. Note that following syntax also works: \texttt{X-10:M+10} or  \texttt{X-10:M}, etc. \\
  \texttt{Note 3:} You can also define valence/conduction band minimum/maximum for DFT or TBA bands by providing  \texttt{VBMT}, \texttt{CBMT}, \texttt{VBMD}, \texttt{CBMD}. Once it has been defined, you can use this acronym in weight define as above WEIGHT setup example. You can also add or subtract some amount you wish to this value when specifying range, for example, \texttt{VBMD}-2:\texttt{VBMD}+2, which will be applying 15:19 if \texttt{VBMD} = 17. \index{SET!WEIGHT!VBMD} \index{SET!WEIGHT!CBMD} \index{SET!WEIGHT!VBMT} \index{SET!WEIGHT!CBMT}
  

 
 	\item[\namedlabel{tag:CONSTRAINT}{CONSTRAINT TBPARAM}] \index{SET!CONSTRAINT}
		Setting for parameter constraints for the fitting and calculation.
		The value of the specified two parameter will be kept same during the
		fitting and tight-binding calculations. 
		If you are using \ref{tag:GA}/\ref{tag:PSO} method for the fitting procedures (\ref{tag:LSTYPE}), you are encouraged to give upper bound and lower bound for each parameters to minimize parameter search field in the randomize procedures of \ref{tag:GA}/\ref{tag:PSO} method. The default lower/upper bound for every parameter is -20.0/20.0. %Note that imposing the upper/lower bound for the parameter is not supported for \ref{tag:LMDIF} method in the current version.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= CONSTRAINT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}CONSTRAINT
        \textgreen{e_py_S}  = \textgreen{e_px_S}  # e_py_S is enforced to be same as e_px_S. 
        \textgreen{e_px_S}  <=  5.0  # upper bound for e_px_S  
        \textgreen{e_px_S}  >= -5.0  # lower bound for e_px_S 
    \color{blue}END \color{red}CONSTRAINT
 \end{Verbatim} 
 		\index{SET!CONSTRAINT!=}
 		\index{SET!CONSTRAINT!$<$=}
 		\index{SET!CONSTRAINT!$>$=}
		If the second argument `=' is replaced by `==' and the third argument \index{SET!CONSTRAINT!==}
		is not present, then this parameter will not be fitted and its initial
		guess as defined in \ref{tag:PFILE} will be fixed during the fitting procedures.
		Note that, exactly same effect can be achieved by putting `\texttt{FIXED}' tag
		at the parameter specification line of the \ref{tag:PFILE}, and the detailed 
		explanation can be found in \ref{tag:param-fix} of Sec.\ref{tag:PFILE-detail}.
		
 Note: Some special rule can be applied in parameter.
 For example, assuming that $s$ and $p_x$ orbital are in atom A and B.
 Then, one can consider hopping parameter such as $sps\_1\_AB$.
 In this case, usually, hopping between orbital s in A and orbital $p_x$ in B 
 is differ from hopping between orbital $p_x$ in A and orbital $s$ in B since 
 atom A and atom B is different species. [see section \ref{tag:PFILE-detail}.Details of the format of PFILE]
 However, in many reason, sometimes it is useful to distinguish A and B although they are same species, for example, S atom of 2H-MoS2 monolayer. Here, one can specify S atom in upper layer to Mo layer  as Sa and S atom in lower layer to Mo layer as Sb. In this case, to correctly define hopping between s and p orbitals in Sa and Sb, one should provide following hopping parameter separately: $sps\_1\_SaSb$, $pss\_1\_SaSb$. It is bothering to write same values twice with just changing sp to ps. And it should be specified in the constraint section that $pss\_1\_SaSb$ = $sps\_1\_SaSb$. It can be avoided if one provide constraint statement that atom Sb and atom Sa are actually same species as follows:
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= CONSTRAINT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}CONSTRAINT
        ....
        ....
        \textgreen{atom_Sb}  = \textgreen{atom_Sa}
        ....
        ....
    \color{blue}END \color{red}CONSTRAINT
 \end{Verbatim}
  Now, it is enough to provide $sps\_1\_SaSb$ only for the $s$ and $p$ orbital hopping parameters between Sa and Sb atom.
  
  Note: If you have set \ref{tag:STMPLOT} or \ref{tag:EIGPLOT}, you should make sure that the name of the atomic species you provided is in the periodic table. For example, suppose you set \texttt{Nb1} atom in your \ref{tag:PFILE}, and want to calculate \ref{tag:STMPLOT}. And you want \texttt{Nb1} atom actually to represent \texttt{Neobium}, you can define its species implicitly as follows:
  
  \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= CONSTRAINT setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}CONSTRAINT
        ....
        \textgreen{atom_Nb1}  = \textgreen{spec_Nb}
        ....
    \color{blue}END \color{red}CONSTRAINT
 \end{Verbatim}
 		This is important since atomic orbital radius is influenced by its nuclear charge.
 		



 	\item[\namedlabel{tag:NNCLASS}{NN\_CLASS}] \index{SET!NN\_CLASS}
		Setting for nearest neighbor set up. \\
		If the distance \texttt{d} between two atomic species (For example, \texttt{Mo} 
		and \texttt{S}) is within 1st nearest type, and its upper limit is 3.2 
		angstrom (e.g., below this value will be regarded as the pair), then
		we can set as follows,
        \begin{verbatim}
         	Mo-S : 3.2  R0 3.171634
        \end{verbatim}  

		Here, number of dash '-' occurence between two atomic species indicates 
		the distance class $n$, and the above example represents 1st nearest 
		hopping between \texttt{Mo} and \texttt{S}. The following \texttt{R0} \index{SET!NN\_CLASS!R0}
		tag defines optimal bonding distance between two neighbor pair. 
		This value will be used in calling the scaling function to get 
		the distance dependent hopping parameter. \texttt{R0} is reference distance that the hopping parameter will not be scaled. See ~\ref{tag:SKSCALEMODE} for details.

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= NN\_CLASS setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}NN_CLASS
        \textgreen{Mo-Mo}  : 3.2   \textgreen{R0} 3.171634
        \textgreen{S-S}    : 3.18  \textgreen{R0} 3.171634  
        \textgreen{S--S}   : 3.2   \textgreen{R0} 3.193724  
        \textgreen{Mo-S}   : 2.5   \textgreen{R0} 2.429624  
    \color{blue}END \color{red}NN_CLASS
 \end{Verbatim}


 	\item[\namedlabel{tag:RIBBON}{RIBBON}] \index{SET!RIBBON}
		Setting for nanoribbon calculations. \\
		At the initial stages of the calculations, \tbfitname{} will generate
		\ref{tag:GFILE}\texttt{-ribbon} with the settings bellow.
		\subitem NSLAB $integer$ : multiplication of unitcell along each direction \index{SET!RIBBON!NSLAB}
		\subitem VACUUM  $real$  : vacuum spacing along each direction.  \index{SET!RIBBON!VACUUM}
		\subitem KFILE\_R $real$  : \ref{tag:KFILE} for ribbon band structure. \index{SET!RIBBON!KFILE\_R}
			Default: \ref{tag:KFILE}
		\subitem PRINT\_ONLY\_R $logical$  : if \texttt{.TRUE.} the geometry \index{SET!RIBBON!PRINT\_ONLY}
		file will be generated with \texttt{-ribbon} suffix to the \ref{tag:GFILE}
		and the program will imedietly stops. Default: \texttt{.FALSE.}
		
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= Ribbon calculation setup,
    labelposition=bottomline]
    \color{blue}SET \color{red}RIBBON
        \color{green!50!black}NSLAB        \color{black}1 20  1
        \color{green!50!black}VACUUM       \color{black}0 20  0
        \color{green!50!black}KFILE_R      \color{black}KPOINTS_RIBBON
        \color{green!50!black}PRINT_ONLY_R \color{black}.FALSE. or. TRUE.
    \color{blue}END \color{red}RIBBON
 \end{Verbatim}

%   SET  Z2 # setup for evaluating Z2 index
%        Z2_ERANGE    1:8   # up to occupied states!! (very important)
%        Z2_DIMENSION 2D:B3 # or 3D or 2D:b3, 1D:b1
%        Z2_NKDIV    11 111  # number of division of the k-path (odd number suggested)
%   END  Z2

    \item[\namedlabel{tag:Z2}{Z2\_INDEX}] \index{SET!Z2\_INDEX} Automatic calculations for topological index 
        $[\nu_0\; \nu_1, \nu_2, \nu_3]$ for 3D or $\mathbb{Z}_{2}$ for 2D via \ref{tag:WCC} method. 
  %		(The current version does not support
   %     \texttt{MPI} parallelism for the Wannier charge center evaluation subroutine.
   %     Hence, do not use multicore for this particular calculation.
   %     Nevertheless, the compilation with \texttt{-DMPI} option is accepted.)
        The output will be written at \texttt{Z2.WCC.}\textgreen{plane\_index}\texttt{.dat} and
        \texttt{Z2.GAP.}\textgreen{plane\_index}\texttt{.dat}.
        Here, \textgreen{plane\_index} indicates one of six $B_i$-$B_j$ plane with $B_k$ = 0 or $\pi$.
        For example, if \textgreen{plane\_index} = \textgreen{0.0-B3.B1\_B2-PLANE}, then it contains
        WCC information of $B1$-$B2$ plane with $k_z$ = $\pi$.
        
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= Z2 index calculation using WCC method,
    labelposition=bottomline]
    \color{blue}SET \color{red}Z2_INDEX
        \color{green!50!black}Z2_ERANGE    \color{black}1:28  # upto occupied \index{SET!Z2\_INDEX!Z2\_ERANGE}
        \color{green!50!black}Z2_DIMENSION \color{black}3D  # or 2D:kz (2D WCC plane perpendicular to kz) \index{SET!Z2\_INDEX!Z2\_DIMENSION}
        \color{green!50!black}Z2_NKDIV  \color{black}21 21 # k-grid for KPATH and k-direction for WCC \index{SET!Z2\_INDEX!Z2\_NKDIV}
        \color{green!50!black}Z2_CHERN  \color{black}.TRUE. # 1st Chern number of given bands with ERANGE \index{SET!Z2\_INDEX!Z2\_CHERN}
    \color{blue}END \color{red}Z2_INDEX
 \end{Verbatim}

    \item[\namedlabel{tag:WCC}{WCC}] \index{SET!WCC} Wannier Charge Center calculation settings
  %      (The current version does not support
 %       \texttt{MPI} parallelism for the Wannier charge center evaluation subroutine. 
 %       Hence, do not use multicore for this particular calculation. 
 %       Nevertheless, the compilation with \texttt{-DMPI} option is accepted.)
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= Wannier charge center (WCC) setup: kz 0.5 (shift),
    labelposition=bottomline]
    \color{blue}SET \color{red}WCC
        \color{green!50!black}WCC_ERANGE \color{black}1:28  # upto occupied \index{SET!WCC!WCC\_ERANGE}
        \color{green!50!black}WCC_FNAME  \color{black}WCC.OUT.dat \index{SET!WCC!WCC\_FNAME}
        \color{green!50!black}WCC_FNAME_GAP \color{black}WCC.GAP.dat  # largest gap will be written \index{SET!WCC!WCC\_FNAME\_GAP}
        \color{green!50!black}WCC_KPATH  \color{black}0 0 0  1 0 0 # k_init -> k_end (ex, along b1) \index{SET!WCC!WCC\_KPATH}
        \color{green!50!black}WCC_KPATH_SHIFT  \color{black}0 0 0.5 # kpoint shift along b3 direction \index{SET!WCC!WCC\_KPATH\_SHIFT}
        \color{green!50!black}WCC_DIREC  \color{black}2 #k-direction for WCC evolution (1:b1,2:b2,3:b3) \index{SET!WCC!WCC\_DIREC}
        \color{green!50!black}WCC_NKDIV  \color{black}21 21 # k-grid for KPATH and k-direction(odd number) \index{SET!WCC!WCC\_NKDIV}
        \color{green!50!black}WCC_CHERN  \color{black}.TRUE. # 1st Chern number of given bands with ERANGE \index{SET!WCC!WCC\_CHERN}
    \color{blue}END \color{red}WCC
 \end{Verbatim}


 	\item[\namedlabel{tag:ZAKPHASE}{ZAK\_PHASE}] \index{SET!ZAK\_PHASE}
		Setting for Zak phase calculations. 
		%(The current version does not support \texttt{MPI} parallelism for the Zak phase evaluation subroutine. Hence, do not use multicore for this particular calculation. However, the compilation with \texttt{-DMPI} option is accepted.)

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= Zak phase setup,
    labelposition=bottomline]
    \color{blue}SET \color{red}ZAK\_PHASE
        \color{green!50!black}ZAK_ERANGE \color{black}1:28  # upto occupied \index{SET!ZAK\_PHASE!ZAK\_ERANGE}
        \color{green!50!black}ZAK_FNAME  \color{black}ZAK_PHASE.OUT.dat  \index{SET!ZAK\_PHASE!ZAK\_FNAME}
        \color{green!50!black}ZAK_KPATH  \color{black}0 0 0  1 0 0 # k_init -> k_end (ex, along b1) \index{SET!ZAK\_PHASE!ZAK\_KPATH}
        \color{green!50!black}ZAK_DIREC  \color{black}2 #k-direction for Zak phase evolution (1:b1,2:b2,3:b3) \index{SET!ZAK\_PHASE!ZAK\_DIREC}
        \color{green!50!black}ZAK_NKDIV  \color{black}21 21 # k-grid for KPATH and k-direction \index{SET!ZAK\_PHASE!ZAK\_NKDIV}
    \color{blue}END \color{red}ZAK\_PHASE
 \end{Verbatim}

    \item[\namedlabel{tag:BERRYC}{BERRY\_CURVATURE}] \index{SET!BERRY\_CURVATURE}
		Setting for Berry curvature calculations.
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
	label= Berrycurvature setup,
	labelposition=bottomline]
    \color{blue}SET \color{red}BERRY_CURVATURE  \index{SET!BERRY\_CURVATURE!BERRYC\_METHOD}
        \color{green!50!black}BERRYC_METHOD \color{black}KUBO # .or. RESTA(not yet supported)  \index{SET!BERRY\_CURVATURE!BERRYC\_METHOD}  \index{SET!BERRY\_CURVATURE!KUBO} \index{SET!BERRY\_CURVATURE!RESTA}
        \color{green!50!black}BERRYC_ERANGE \color{black}17:18  \index{SET!BERRY\_CURVATURE!BERRYC\_ERANGE}
        \color{green!50!black}BERRYC_FNAME  \color{black}BERRYCURV.17-18 # output will be \textgreen{BERRYC\_FNAME}.dat  \index{SET!BERRY\_CURVATURE!BERRYC\_FNAME}
        \color{green!50!black}BERRYC_DIMENSION \color{black}2D:B3  # 2D plane perpendicular to kz)  \index{SET!BERRY\_CURVATURE!BERRYC\_DIMENSION}
    \color{blue}END \color{red}BERRY_CURVATURE
 \end{Verbatim}

    \item[\namedlabel{tag:PARITY}{PARITY\_CHECK}] \index{SET!PARITY\_CHECK}
		Setting for Parity eigenvalue calculations for given $k$-points.
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
	label= Parity check setup,
	labelposition=bottomline]
    \color{blue}SET \color{red}PARITY_CHECK
        \color{green!50!black}PARITY_KP \color{black}0.0 0.0 0.0  G    # Gamma (reciprocal unit)  \index{SET!PARITY\_CHECK!PARITY\_KP}
        \color{green!50!black}PARITY_KP \color{black}0.5 0.0 0.0  M1   # M1    (reciprocal unit)
        \color{green!50!black}PARITY_KP \color{black}0.0 0.5 0.0  M2   # M2    (reciprocal unit)
        \color{green!50!black}PARITY_KP \color{black}0.5 0.5 0.0  M3   # M3    (reciprocal unit)
        \color{green!50!black}PARITY_ORIGIN \color{black}0.0 0.0 0.0 # origin of the system (direct coord)  \index{SET!PARITY\_CHECK!PARITY\_ORIGIN}
        \color{green!50!black}PARITY_OP1 \color{black}-1  0  0 # Rotation matrix (R) for inversion  \index{SET!PARITY\_CHECK!PARITY\_OP1}
        \color{green!50!black}PARITY_OP2 \color{black} 0 -1  0 # => R*X=-X (invert coordinate)  \index{SET!PARITY\_CHECK!PARITY\_OP2}
        \color{green!50!black}PARITY_OP3 \color{black} 0  0 -1 # => X:direct coord ; R: integer 3x3 array  \index{SET!PARITY\_CHECK!PARITY\_OP3}
        \color{green!50!black}NOCC \color{black} 10 # 10 occupied states  \index{SET!PARITY\_CHECK!NOCC}
        \color{green!50!black}PRINT_HAMILTONIAN \color{black} .FALSE. # print out H(k) for each k-point  \index{SET!PARITY\_CHECK!PRINT\_HAMILTONIAN}             
    \color{blue}END \color{red}PARITY_CHECK
 \end{Verbatim}
 \texttt{Note:} \\
 $\bullet$ You can add (or remove) \texttt{PARITY\_KP} tag if you want to get the parity information for another \texttt{TRIM} (time reversal invariant momenta: -$k$=$k$+$G$) point. \\
 $\bullet$ To use this functionality and to get the meaningful results, your system should have inversion symmetry. \\
 $\bullet$ The \texttt{ROTATION} tag is optional, the default is
 \[
  R=
  \left[ {\begin{array}{c}
   PARITY\_OP1\\
   PARITY\_OP2\\
   PARITY\_OP3\\
  \end{array} }\right]
  =
  \left[ {\begin{array}{ccc}
   -1 & 0 & 0\\
   0 & -1 & 0\\
   0 & 0 & -1\\
  \end{array} } \right]
\].


    \item[\namedlabel{tag:SYMMETRY}{SYMMETRY\_EIG}]  \index{SET!SYMMETRY\_EIG}
		Setting for Symmetry eigenvalue calculations for given $k$-points.
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
	label= Parity check setup,
	labelposition=bottomline]
    \color{blue}SET \color{red}SYMMETRY_EIG
        \color{green!50!black}SYMMETRY_KP \color{black}0.0 0.0 0.0  G    # Gamma (reciprocal unit)  \index{SET!SYMMETRY\_EIG!SYMMETRY\_KP}
        \color{green!50!black}SYMMETRY_ORIGIN \color{black}0.0 0.0 0.0 # origin of the system (direct coord)  \index{SET!SYMMETRY\_EIG!SYMMETRY\_ORIGIN}
        \color{green!50!black}SYMMETRY_OP1 \color{black}-1 -1  0 # Rotation matrix (R) for 2/3pi  \index{SET!SYMMETRY\_EIG!SYMMETRY\_OP1}
        \color{green!50!black}SYMMETRY_OP2 \color{black} 0  1  0 # \index{SET!SYMMETRY\_EIG!SYMMETRY\_OP2}
        \color{green!50!black}SYMMETRY_OP3 \color{black} 0  0  1 # \index{SET!SYMMETRY\_EIG!SYMMETRY\_OP3}
        \color{green!50!black}ROT_ANGLE \color{black} 120 # rotation angle counterclockwise \index{SET!SYMMETRY\_EIG!ROT\_ANGLE}
        \color{green!50!black}NOCC \color{black} 10 # 10 occupied states \index{SET!SYMMETRY\_EIG!NOCC}
        \color{green!50!black}PRINT_HAMILTONIAN \color{black} .FALSE. # print out H(k) for each k-point  \index{SET!SYMMETRY\_EIG!PRINT\_HAMILTONIAN} 
    \color{blue}END \color{red}SYMMETRY_EIG
 \end{Verbatim}

 $\bullet$ The \texttt{SYMMETRY\_OP} tag represents Rotation matrix \texttt{R} that will be multiplied to atomic position \texttt{$r$}
 to rotate to new position \texttt{$r'$}, $r' = R^Tr$, where $R^T$ is transpose of $R$.
  
  
     \item[\namedlabel{tag:EFFECTIVE}{EFFECTIVE}] \index{SET!EFFECTIVE}
		Setting for evaluating effective hamiltonian and its eigenvalues. This job will be performed by the L\"owdin downfolding technique\footnote{
		\texttt{P.-O. L\"owdin, \href{https://aip.scitation.org/doi/abs/10.1063/1.1748067}{J. Chem. Phys. 19, 1396 (1951)}}\\
		\texttt{E. Zurek, O. Jepsen, O. K. Anderson, \href{https://onlinelibrary.wiley.com/doi/abs/10.1002/cphc.200500133}{Chem. Phys. Chem. 6, 1934 (2005)}}}. Note that in the current version, only the $energy$-dependent effective Hamiltonian will be constructed, where the $energy$ is representing one's interested region.
		

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
	label= Effective Hamiltonian construction,
	labelposition=bottomline]
    \color{blue}SET \color{red}EFFECTIVE HAM
        \color{green!50!black}EFF_ORB \color{black}C:pz # downfolding will be performed on these orbitals  \index{SET!EFFECTIVE!EFF\_ORB}
        \color{green!50!black}EFF_EWINDOW \color{black}-2:2 # energy window of interest (e_center=-2+2/2)  \index{SET!EFFECTIVE!EFF\_EWINDOW}
    \color{blue}END \color{red}EFFECTIVE HAM
 \end{Verbatim}


     \item[\namedlabel{tag:REPLOT}{REPLOT}]  \index{SET!REPLOT}
		Setting for replotting where DOS/LDOS/PBAND represents density of states (DOS), local density of states (LDOS), and atom-projected band structure (PBAND) by reading \texttt{band\_structure.dat} or \texttt{band\_structure.up(dn).dat} file, respectively.
		
 \begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= DOS setup example,
    labelposition=bottomline]
    \color{blue}SET \color{red}REPLOT
      \textgreen{FILE_FORMAT} bin  # let code know what kind of \index{SET!REPLOT!FILE\_FORMAT}
                       # \textblue{band_structure_TBA} file to be read.
                       # if \textblue{bin} : \textblue{band_structure_TBA.(up/dn).bin}
                       # if \textblue{dat} : \textblue{band_structure_TBA.(up/dn).dat}
                       # will be loaded. Default: \textblue{dat}
      \textgreen{REPLOT_BAND} .TRUE. wf # replot band structure \index{SET!REPLOT!REPLOT\_BAND}
         # with wavefunction coefficient (with tag \textblue{wf}). Instead of 
         # \textblue{wf} tag, one can also request \textblue{rh}, \textblue{mx}, \textblue{my}, \textblue{mz}, where the 
         # meaning of each tag can be found in \ref{tag:LORBIT} tag.
         # If no additional tag is specified, set to \textblue{rh} by default.
         # If \textblue{no} tag is specified, only energy band without orbital 
         # information will be printed out. The output file will be
         # written in \textblue{band_structure_TBA.replot_wf.(up/dn).dat} file
         # with ascii format.
         # Note that to activate this tag, \textblue{FILE_FORMAT} tag should be 
         # set to \textblue{bin} and corresponding file \textblue{band_structure_TBA}
         # \textblue{.(up/dn).bin} should be exist in the folder.
      \textgreen{REPLOT_PROJ_BAND} .TRUE. 1:8 12 # replot projected band structure \index{SET!REPLOT!REPLOT\_PROJ\_BAND}\\
                                     # for given atoms and their sum
      \textgreen{REPLOT_DOS} .TRUE. # Recalculate DOS using pre-calculated \index{SET!REPLOT!REPLOT\_DOS}\\ 
                      # band_structure file, e.g., \\ 
                      # \texttt{band\_structure.dat} (nonmagnetic or \\
                      # non-collinear) or \texttt{band\_structure.up/dn.dat} \\
                      # (spin polarized case).
      \textgreen{REPLOT_LDOS} .TRUE. 1:8 12 # Print local density of states for \index{SET!REPLOT!REPLOT\_LDOS}\\
                               # given atoms. For example, here, \\
                               # 1st to 8-th atoms and 12-th \\
                               # atoms will be resolved.
      \textgreen{REPLOT_DIDV} .TRUE. # Print local density of states for given \index{SET!REPLOT!REPLOT\_DIDV}\\ 
                         # discrete energy level within DOS_EWINDOW. \\
                         # The outputs will be stored in \\ 
                         # ./didv/DIDV.replot.dat.#i where #i=[1:NEDOS]                           
      \textgreen{SMEARING} 0.03 # gaussian smearing. Default = 0.025 \index{SET!REPLOT!SMEARING}
      \textgreen{NEDOS}    2000 # number of grid points in energy window (erange) \index{SET!REPLOT!NEDOS}
      \textgreen{DOS_EWINDOW} -20.0:10.0 # energy window to be plotted \index{SET!REPLOT!DOS\_EWINDOW}
      
      \textgreen{REPLOT_SLDOS} .TRUE. # spatial LDOS within EWINDOW \index{SET!REPLOT!REPLOT\_SLDOS}
      \textgreen{REPEAT_CELL}  20 20 1 # if REPLOT_SLDOS = .TRUE.,  \index{SET!REPLOT!REPEAT\_CELL}
                           # cell periodicity for visualization
      \textgreen{RORIGIN}  0.0 0.0 0.0 # shift of origin of atomic coordinates \index{SET!REPLOT!RORIGIN}
                           # (fractional to unit vector a1, a2, a3, 
                           # respectively). 
      \textgreen{BOND_CUT} 1.8  # bond length <= bond_cut will not be written in \index{SET!REPLOT!BOND\_CUT}
                    # BOND.replot.dat Default: 3.0 (ang)                   
    \color{blue}END \color{red}DOS
 \end{Verbatim}

 \texttt{Note 1:} This tag is useful if you want to get series of DOS/LDOS 
 calculations with respect to the \texttt{SMEARING} and energy window.
 If this \texttt{SET} is activated, other calculations will be ignored and 
 the program stops immediately after the calculation. 
 
 \texttt{Note 2:} If \texttt{REPLOT\_DOS = .TRUE.} or \texttt{REPLOT\_LDOS = .TRUE.} or
\texttt{REPLOT\_SLDOS = .TRUE.}, then it is encouraged to set 
\texttt{SMEARING}, \texttt{NEDOS}, \texttt{DOS\_EWINDOW}, 
otherwise the default values will be used. 

 \texttt{Note 3:} If \texttt{REPLOT\_SLDOS = .TRUE.}, then, \texttt{REPEAT\_CELL},
 \texttt{RORIGIN}, \texttt{BOND\_CUT} should be set together, 
 otherwise the default values will be used. 
 
 \texttt{Note 4:} The output file names are as follows: \\
 $\bullet$ if \texttt{REPLOT\_DOS = .TRUE.} $\rightarrow$ \texttt{DOS.replot.dat} \\
 $\bullet$ if \texttt{REPLOT\_LDOS = .TRUE.} $\rightarrow$ 
 \texttt{LDOS.replot.ATOM\_INDEX.dat}, where \texttt{ATOM\_INDEX} is the atom number. The example can be found in the ``\texttt{Example/Graphene/\\DENSITY\_OF\_STATE/replot}" of your example folder. \\
 $\bullet$ if \texttt{REPLOT\_DOS = .TRUE.} $\rightarrow$ \texttt{SLDOS.replot.dat} and 
 \texttt{BOND.replot.dat}.\\
The example can be found in the ``\texttt{Graphene/QSH/NANORIBBON/\\
zigzag\_ribbon/SPATIAL\_LDOS\_REPLOT}" of your example folder.\\

 \texttt{Note 5:} The multiple declaration of \texttt{REPLOT\_BAND}, \texttt{REPLOT\_PROJ\_BAND} and \texttt{REPLOT\_LDOS} tag result in multiple \texttt{band\_structure\_TBA.replot\_\textblue{??}.dat}, \\ \texttt{band\_structure\_TBA\_atom.sum\textblue{\#}.dat} and \texttt{LDOS.replot.sum\textblue{\#}.dat} files, respectively, where \textblue{??} represents one of \textblue{\{rh, mx, my, mz, wf\}} tag you specified and \textblue{\#} represents the order of declaration of the tag. The concept of multiple declaration is same as in
     \ref{tag:PROJBAND} tag.
     
 \texttt{Note 6:} The purpose of \texttt{REPLOT\_BAND} tag is clear
 as it only read \textblue{.bin} file and write \textblue{.dat}. That is, for converting binary file format into human readable ascii format.
     \ref{tag:PROJBAND}.

 \texttt{Note 7:} If you add \textblue{bin} or \textblue{bin4} tag at the end of \texttt{REPLOT\_BAND} tag, for example,

 \begin{Verbatim}[commandchars=\\\{\},gobble=4, framesep=2mm]
    \textgreen{REPLOT\_BAND} .TRUE. rh \textblue{bin (or bin4)}
 \end{Verbatim}
   then the result will be written with unformatted format with single precision. This is only available if your target file is already written in \textblue{bin} (or \textblue{bin4} ; single precission) (see the \ref{tag:LORBIT} tag for the details). Using this tag, ascii formatted file can be saved in unformatted file, e.g., (\texttt{band\_structure\_TBA.dat} $\rightarrow$ \texttt{band\_structure\_TBA.bin}).

\end{description}



\section{Details of the format of \texttt{GFILE}}\label{tag:GFILE-detail}
%\subsubsection*{Input Syntax for Regular Expression Extraction Pattern}
\begin{description}

    \item[\namedlabel{tag:ATOMICORB}{Atomic orbital setup}] $string$ \\
        Hydrogen-like atomic orbital can be specified for the orbital basis.
        The possible orbital basises are\footnote{Please note that current 
		version does not support the $f$ orbitals.
        However, we will include $f$ in the future release of \tbfitname{}. 
		For the \texttt{Slater-Koster} tables of $f$ orbitals, please see
		[\texttt{K. Lendi, 
		\href{https://journals.aps.org/prb/abstract/10.1103/PhysRevB.9.2433}
		{Phys. Rev. B 9, 2433 (1974)}}].}:
        \begin{verbatim}
         s px py pz dz2 dxy dx2 dxz dx2
        \end{verbatim}


\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= setup of atomic orbital basis in \ref{tag:GFILE},
    labelposition=bottomline]
  0.0 0.0 0.0 s px py pz  \# s, px, py, and pz orbitals at ATOM_A
  0.0 0.0 0.5 s px py pz  \# s, px, py, and pz orbitals at ATOM_B

\end{Verbatim}

    \item[\namedlabel{tag:CUSTOM}{Custumized atomic orbital setup}] $string$ \\
        If someone does not want to use \texttt{Slater-Koster} type interatomic
        hopping parameter, customized atomic orbital can be defined instead.
        In this case, distance and hopping pair dependent parameterization
        should be properly defined in the \ref{tag:PFILE}. \\
        $Warning:$ This is experimental feature and on the development stages (do not use).
        

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= setup of custumized atomic orbital name $cp1$,
    labelposition=bottomline]
  0.0 0.0 0.0 cp1  \# cp1 orbital at ATOM_1
  0.0 0.0 0.5 cp1  \# cp1 orbital at ATOM_2

\end{Verbatim}


    \item[\namedlabel{tag:MOMENT}{MOMENT}] tag $real$ \\
		Magnetic moment for Each atomic orbital can be assigned as follows,
	\subitem collinear case: \texttt{0.0}
    \subitem noncollinear case: \texttt{0.0 0.0 0.0 [$M$ $\theta$ $\phi$]}\\
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= usage of $moment$ tag in \ref{tag:GFILE} with $collinear$ magnetism,
    labelposition=bottomline]
  0.0 0.0 0.0 px py pz \textgreen{moment} 0 0  1 \# spin-up for pz
  0.0 0.0 0.5 px py pz \textgreen{moment} 0 0 -1 \# spin-dn for pz

\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= usage of $moment$ tag in \ref{tag:GFILE} with $noncollinear$ magnetism,
    labelposition=bottomline]
  0.0 0.0 0.0 px py pz \textgreen{moment} 0 0 0  0 0 0  1 0 0  \# spin-up for pz
  0.0 0.0 0.5 px py pz \textgreen{moment} 0 0 0  0 0 0 -1 0 0  \# spin-dn for pz

\end{Verbatim}

    \item[\namedlabel{tag:MOMENT.C}{MOMENT.C}] tag $real$ \\
        Similar to \ref{tag:MOMENT} but in \texttt{noncollinear} case,
		the 1$^{st}$, 2$^{nd}$, and 3$^{rd}$ value represents, $m_x$, $m_y$, and $m_z$, respectively.
		Here, $x$, $y$, and $z$ represents the cartesian axis.
    \subitem noncollinear case: \texttt{0.0 0.0 0.0 [$M_x$ $M_y$ $M_z$]}\\

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= usage of $moment.c$ tag in \ref{tag:GFILE} with $noncollinear$ magnetism,
    labelposition=bottomline]
  0.0 0.0 0.0 px py pz \textgreen{moment.c} 0 0 0  0 0 0  0 0  1 \# spin-up for pz
  0.0 0.0 0.5 px py pz \textgreen{moment.c} 0 0 0  0 0 0  0 0 -1 \# spin-dn for pz

\end{Verbatim}

\end{description}

\section{Details of the format of \texttt{PFILE}}\label{tag:PFILE-detail}
%\subsubsection*{Input Syntax for Regular Expression Extraction Pattern}
\begin{description}
	\item[\namedlabel{tag:OVERLAP}{USE\_OVERLAP}] \index{USE\_OVERLAP} $logical$ \\
		For the use of non-orthogonal basis, and thereby to indicate their corresponding overlap integral paramters, 
		one should activate \ref{tag:OVERLAP} to \texttt{.TRUE.} and apply appropriate parameters starting with $\texttt{o\_}$ prefix.
        \begin{verbatim}
         USE_OVERLAP .TRUE.
        \end{verbatim}
        
		The details for the naming convention of the overlap integral parameters is described in the following sections. 

	\item[\namedlabel{tag:SKSCALEMODE}{SK\_SCALE\_MODE}] \index{SK\_SCALE\_MODE} $integer$ \\
		Defines scaling function $f_s(\emph{d},\emph{R}_0,\alpha)$ of Slater-Koster hopping parameters $t$ with respect to the distance between atomic orbitals $\emph{r}$: $t' = t * f_s(\emph{d},\emph{R}_0,\alpha)$, where $\alpha$ is the scaling parameter which will be explained in the following section \ref{tag:hopping_type}. 
		The usage is as follows (ex, mode = 1 case):
	    \begin{verbatim}
         SK_SCALE_MODE 1 # MODE = 1
        \end{verbatim}

		\item $\bullet$ mode 1: \texttt{SK\_SCALE\_MODE 1} \\
		 Ref. PRB 85.195458 (2012): for interlayer pz-pz interaction of twisted bilayer graphene. \\
		  $f_s = \exp{ \frac{R_0 - d}{\alpha R_0} }$ 
		\item $\bullet$ mode 2: \texttt{SK\_SCALE\_MODE 2} \\
		 Ref. PRB 92.205108 (2015): for interlayer p-p interaction of layered TMDC material. \\
		  $f_s = \exp{ (-\frac{d}{R_0})^\alpha }$ 
		\item $\bullet$ mode 3: \texttt{SK\_SCALE\_MODE 3} \\
		 Ref. PRB 51.16772 (1995): for s-p or p-p interaction of Silicon or Germanium crystal. \\
		  $f_s = (\frac{R_0}{d})^\alpha$ 
		\item $\bullet$ mode 4: \texttt{SK\_SCALE\_MODE 4} \\
		 Ref. PRB 93.241407 (2016) : In-Si case. \\
		  $f_s = \exp ({R_0 - d})\alpha$ 
		\item $\bullet$ mode 5: \texttt{SK\_SCALE\_MODE 5} \\
		 Linear scaling method. \\
		  $f_s = 1 - \alpha (d - R_0)$ 
		
    \item[\namedlabel{tag:param-onsite}{ONSITE parameters}] $real$ \\
		Onsite prameters for each atomic orbital should have the prefix
		\textgreen{e\_} and joint with the name of the orbital. The suffix
		should be the atomic species where the orbital placed.
        \begin{verbatim}
         e_dx2_Mo      -0.34
        \end{verbatim}

    \item[\namedlabel{tag:hopping_type}{HOPPING parameters type}] $real$ \\
        The type of tight binding hopping parameter used in the calculations.

		\subitem $case 1.)$ \texttt{Slater-Koster type parameter} \\
		 The syntax is as follwos:
        \begin{Verbatim}[commandchars=\\\{\}]
         \textgreen{hopping-type}_\textpink{nn-class}_\textred{A}\textblue{B}
        \end{Verbatim}
		\texttt{hopping-type} will have one of following prefix: \{ $ss$, $sp$, $sd$, $pp$, 
		$pd$, $dd$ \}, and one of following suffix: \{$s$, $p$, $d$ \}, which implies
		$\sigma$-, $\pi$-, and $\delta$-type inteaction.
		\textpink{nn-class} specifies the distance class. See \ref{tag:NNCLASS} for the 
		details.

		\textred{A}\textblue{B} specifies the two atomic species (\textred{A} and \textblue{B} atoms) 
		where the orbital hopping take place. 
		For example, for the $dd\delta$ \texttt{Slater-Koster} parameter involved with 
		the hopping process between the $\textgreen{d}_{z2}$ orbital in \textred{Mo} atom 
		and $\textgreen{d}_{yz}$ orbital in \textblue{Mo}, 
		and they are \textpink{2$^{nd}$} neighbor pair, then the parameter should be the following form:
        \begin{verbatim}
         ddd_2_MoMo   -0.2
        \end{verbatim}
   
   		To activate the use of Slater-Koster type parameterization scheme,
		 one should put the tag \namedlabel{tag:IS_SK}{\textblue{IS\_SK}}\index{IS\_SK} (default setting) in your ~\ref{tag:PFILE}:
		\begin{Verbatim}[commandchars=\\\{\}]
	 \textgreen{IS_SK} .TRUE.
		\end{Verbatim}
     
        \texttt{IMPORTANT!} If atom \textred{A} and \textblue{B} is different species, special care should be taken in naming parameter.
        For example, assume that each atom \textred{A} and \textblue{B} has orbital $s$, $p_x$. 
        Then one can consider $\sigma$-type first nearest neighbour hopping between $s$ orbital of \textred{A} and $p_x$ orbital of \textblue{B}.
        In this case, such hopping parameter should be written as: $sps$\_1\_$AB$ or $pss$\_1\_$BA$.
        On the other hand, if we consider the hopping between $p_x$ orbital of \textred{A} and $x$ orbital of \textblue{B}, the hopping parameter for this case should be written as: $sps$\_1\_$BA$ or $pss$\_1\_$AB$.

        \begin{Verbatim}[commandchars=\\\{\}]
     Example s and p orbital with different atomic species:
     atom \textred{A} orbital \textred{s} ; atom \textblue{B} orbital \textblue{px} => \textred{s}\textblue{p}s_1_\textred{A}\textblue{B} or \textblue{p}\textred{s}s_1_\textblue{B}\textred{A} 
     atom \textred{A} orbital \textred{px} ; atom \textblue{B} orbital \textblue{s} => \textred{p}\textblue{s}s_1_\textred{A}\textblue{B} or \textblue{s}\textred{p}s_1_\textblue{B}\textred{A} 
        \end{Verbatim}
       


         For the overlap integral parameters, one can add $\texttt{o\_}$ prefix, for example,
        \begin{verbatim}
         o_ddd_2_MoMo   -0.2
        \end{verbatim}
         Note that to activate the use of overlap integral, i.e., assuming the use of non-orthogonal basis, 
         one should put $``$\ref{tag:OVERLAP} \texttt{.TRUE.}$"$ tag into your \ref{tag:PFILE}.
        
        
         To activate the use of scaling functions, i.e., distance dependent rescaling of parameters, 
         one should set corresponding scaling parameters, for example, 
         \begin{verbatim}
         s_ddd_2_MoMo   -0.2
         \end{verbatim}
         to rescale the $\texttt{ddd\_2\_MoMo}$ parameter with respect to the distance and the directional cosine between orbitals. Note again that to apply same rule for the overlap 
         integral parameters, one should put $\texttt{os\_}$ prefix instead, for example,
         \begin{verbatim}
         os_ddd_2_MoMo   -0.2
         \end{verbatim}
        
		\subitem $case 2.)$  \texttt{User defined parameters} \\
		$Warning:$ This is experimental feature and on the development stages. \\
		In this case, the customized atomic orbital is assumed and the 
		following scheme should be applied:
        \begin{Verbatim}[commandchars=\\\{\}]
         \textgreen{hopping-type}_\textpink{nn-class}_\textred{A}\textblue{B}
        \end{Verbatim}
		Here, the basic structure is same as $case 1.)$, however, the syntax of 
		\textgreen{hopping-type} is slightly different. 
		That is: the prefix should have \textgreen{$cc$} since this indicates $customized$ 
		hopping parameters. For the suffix, one should put user defined 
		letter that characterize the hopping.	
		For example,
        \begin{Verbatim}[commandchars=\\\{\}]
         \textgreen{cc}\textpink{a}_2_BiBi      0.01
        \end{Verbatim}
		represents the hopping between 2$^nd$ neighbor \texttt{Bi} atoms with
		the `\textpink{$a$}` type of $rule$ which characterizes hopping pair.
		If you want to setup the $rule$, you have to write the conditions
		to the source code: \texttt{get\_cc\_param.f90}.


%  ! SET UP 'USER' DEFINED HOPPING RULE
%  ! NOTE: In THIS example, hopping between A-A sublattice with x-direction characterized by hopping distance
%  ! at around 11.6 ang is characterized by 'ccx_2_BiBi' since nn_class=2 is predefined in the INCAR-TB 
%  ! with Bi--Bi : 12.0 R0 12.0 where '--' gives us '2'.
%  ! Following do loop will find the parameter named 'ccx_2_BiBi' in the 'param_name' and will asign its
%  ! number as the 'parameter_index' 
	
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= source code example: get\_cc\_param.f90,
    labelposition=bottomline]

		   # SET UP THE `USER' DEFINED HOPPING `RULE'
		   # NOTE: In THIS example, hopping between Bi-Bi atom along 
		   # x-direction characterized by hopping distance at around 
		   # 8.6 \AA (cca_2_BiBi) with nn\_class = 2 will be considered.
		   # Following `\textgreen{if}' routine  will find the parameter named 
		   # cca_2_BiBi in the 'PFILE' and will asign its number as 
		   # the `parameter_index'.

	   	[...]
        \textgreen{elseif( (dij .gt.  8.5) .and. (dij .lt.  8.7)} .and. \textred{&}
					    (ci_atom .eq. cj_atom) ) then 
    	  call get_param_name(cc_custom, param_class, `\textgreen{a}', \textred{&} 
			  			     nn_class, ci_atom, cj_atom, \textred{&}
							      flag_scale)
	   	[...]


\end{Verbatim}

		Note that this mode work with following tag in your ~\ref{tag:PFILE}:
		\begin{Verbatim}[commandchars=\\\{\}]
	 \textgreen{IS_SK} .FALSE.
		\end{Verbatim}
		
    \item[Local potential (\namedlabel{tag:param-locpot}{loc.pot})]\index{loc.pot} parameters $real$ \\
		If you want to apply local potential to the particular atomic site or
		particular orbital, then you can simply turn on \ref{tag:LOCCHG}
		(\texttt{.TRUE.}) and write \texttt{local.pot} tag together with the amount of
		local potential to be applied for each atomic orbitals in the \ref{tag:GFILE}.
		Next, you have to provide proper scaling parameter ($U_{onsite}^i$) for the local 
		potential, since the local potential is applied on your Hamiltonian
		as: $e_{onsite}'^i$ = $e_{onsite}^i$ + $e_{loc.pot}^i$ $\times$ $U_{onsite}^i$,
		i.e., it modifies onsite energy $e_{onsite}^i$ to $e_{onsite}'^i$.
		Here, $U_{onsite}^i$ should be defined in your \ref{tag:PFILE} so that
		the syntax is \texttt{local\_U\_$\textgreen{orbital-type}$\_$\textred{atom-name}$}.
		$\textgreen{orbital-type}$ is one of $s$, $p$, or $d$ type of orbital and 
		$\textred{atom-name}$ is the name of atomic species you want to apply the local
		potential.
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \textgreen{local.pot} tag in \ref{tag:GFILE},
    labelposition=bottomline]
  0.0 0.0 0.0 px py pz \textgreen{local.pot}  1  1  1  \# positive loc.pot
  0.0 0.0 0.5 px py pz \textgreen{local.pot} -1 -1 -1  \# negative loc.pot
\end{Verbatim}
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \textgreen{local.pot} parameter  in \ref{tag:PFILE},
    labelposition=bottomline]
    local_U_\textgreen{p}_\textred{S}  1.0
\end{Verbatim}

    \item[Stoner parameter (\namedlabel{tag:param-moment}{moment or moment.c})]\index{moment}\index{moment.c} $real$ \\
		If you want to apply local magnetic moment to the particular atomic site or
		particular orbital with \texttt{noncollinear} or \texttt{collinear} type, and you have set
		\ref{tag:MOMENT} or \ref{tag:MOMENT.C} properly in your \ref{tag:PFILE-detail}, then 
		you need Stoner parameter $I_{i\mu}$ that specifies the exchange splitting:
		$e_{il}^{exc}$ = $I_{il} \times m_i$, where $i$ indicates atomic species and $l$
		represents angular momentum quantum number $l$. 
		Here, the Stoner-part modifies exclusively the on-site energies of the system.
		The syntax is \texttt{stoner\_I\_$\textgreen{orbital-type}$\_$\textred{atom-name}$}.
		$\textgreen{orbital-type}$ is one of $s$, $p$, or $d$ type of orbital and 
		$\textred{atom-name}$ is the name of atomic species you want to apply the local
		potential.
		
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \textgreen{moment} tag in \ref{tag:GFILE},
    labelposition=bottomline]
  0.0 0.0 0.0 px py pz \textgreen{moment}  1  1  1  \# spin-up
  0.0 0.0 0.5 px py pz \textgreen{moment} -1 -1 -1  \# spin-dn
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \textgreen{stoner} parameter  in \ref{tag:PFILE},
    labelposition=bottomline]
    stoner_I_\textgreen{p}_\textred{S}  1.0
\end{Verbatim}


    \item[\namedlabel{tag:param-soc}{SOC parameters}] $real$ \\
		\subitem $case 1.)$ \ref{tag:IS_SK} \texttt{.TRUE.} \\
       	Every spin-orbit coupling parameters in \texttt{Slater-Koster} method
		should have the prefix with \texttt{lambda\_} and proper orbital information 
		\texttt{$p\_$}(as a joinder, for example $p$ orbital) 
		and species information \texttt{\_S}(as a suffix, for example 
		\texttt{Sulpur} atom) to precisely indicating the 
		atomic orbital where the SOC effect will be applied.
        \begin{verbatim}
         lambda_p_S    0.2
        \end{verbatim}

        \subitem $case 2.)$ \ref{tag:IS_SK} \texttt{.FALSE.} \\
		In the case of user defined hopping parameter (orbital prefix start with $c$,
		see Sec.\ref{tag:GFILE-detail} for the details) has been defined in the 
		\ref{tag:GFILE}, $SOC$ can be considered by setting up the Rashba and in-plane
		spin-orbit interaction.
		For Rashba type $SOC$, the prefix \texttt{lrashba\_} should be joint with 
		nearest neighbor class $n$ and hopping pair as follows.
        \begin{verbatim}
         lrashba_c_2_BiBi    0.2
        \end{verbatim}
		Above setting represents, Rashba type spin-orbit coupling between the
		custum type orbitals with $c$-prefix of the atom \texttt{Bi} and \texttt{Bi}.

	\item[\namedlabel{tag:param-fix}{Fixing parmeter}] $ $ \index{FIXED}\\
		If one want some parameters not to be fitted during the fitting 
		procedures, one can fix thoes parameters by adding \texttt{FIXED} or 
		\texttt{F}.
		For example, if you want \texttt{lambda\_p\_S} to be kept as its initial 
		value, then, set this parameter as follows,
        \begin{verbatim}
         lrashba_c_2_BiBi    0.2 FIXED
        \end{verbatim}

    \item[\namedlabel{tag:param-example}{Example of \ref{tag:PFILE}}] $ $\\

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of PFILE: PARAM\_FIT.dat for MoS$_2$ (IS\_SK  .TRUE.),
    labelposition=bottomline]
       \textgreen{   USE_OVERLAP}      .FALSE.  # assume orthogonal basis sets
       \textgreen{   IS_SK (or USE_SKPARAM)} .TRUE. # Slater-Koster type parameters  
       \textgreen{   SK_SCALE_MODE}  1  # SK scaling factor mode
       
       \textgreen{   e_dz2_Mo}      -0.34636955
       \textgreen{   e_dx2_Mo}      -0.70447045
       \textgreen{   e_dxy_Mo}      -0.70447045
       \textgreen{   e_dxz_Mo}      -0.17913534
       \textgreen{   e_dyz_Mo}      -0.17913534
       \textgreen{     e_pz_S}      -2.96500556
       \textgreen{     e_px_S}      -1.47877518
       \textgreen{     e_py_S}      -1.47877518
       \textgreen{      e_s_S}     -10.51138070
       \textgreen{ dds_1_MoMo}      -1.04598377
       \textgreen{ ddp_1_MoMo}       0.44731993
       \textgreen{ ddd_1_MoMo}       0.10237760
       \textgreen{   pps_1_SS}       0.62323972
       \textgreen{   ppp_1_SS}       0.03251328
       \textgreen{  pds_1_MoS}      -2.32384045
       \textgreen{  pdp_1_MoS}       0.97229680
       \textgreen{   sss_1_SS}      -0.57287106
       \textgreen{   sps_1_SS}      -0.33278732
       \textgreen{   sss_2_SS}      -0.45573348
       \textgreen{   sps_2_SS}      -0.21906117
       \textgreen{  sds_1_MoS}       2.66111706
       \textgreen{lambda_d_Mo}       0.08014531  Fixed
       \textgreen{ lambda_p_S}       0.07567002  Fixed

\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of PFILE: PARAM\_FIT.dat for Bi/Si(110) (IS\_SK  .FALSE.),
    labelposition=bottomline]
     \textgreen{   USE_OVERLAP}      .FALSE.  # assume orthogonal basis sets   
     \textgreen{   IS_SK (or USE_SKPARAM)} .FALSE. # Slater-Koster type parameters  

       \textgreen{        e_cp1_Bi}    -0.09222821  
       \textgreen{      ccb_1_BiBi}     0.01723235  
       \textgreen{      cca_2_BiBi}     0.13290800  
       \textgreen{      ccy_3_BiBi}    -0.0         
       \textgreen{      ccx_4_BiBi}    -0.03544401  
       \textgreen{lrashba_c_1_BiBi}    -0.01119142  
       \textgreen{lrashba_c_2_BiBi}     0.04914549  
       \textgreen{lrashba_c_3_BiBi}    -0.00632175  
       \textgreen{lrashba_c_4_BiBi}    -0.00636364  

\end{Verbatim}
	

\end{description}

\newpage
\part{Examples}
\setcounter{section}{0}

\section{Graphene with $s$ and $p$ orbitals}
	\subsection{Parameter fitting}
		\subsubsection{Prepare main control file: INCAR\_TB}
		$\tbfitname$ reads \ref{tag:INCAR_TB} in the initial stages of the calculations to set up basic control parameters. In addition, \ref{tag:GFILE}, \ref{tag:KFILE}, and \ref{tag:PFILE} is mandatory for the normal run, and it should be predefined in your \ref{tag:INCAR_TB}.
		For the fitting procedures, \ref{tag:TBFIT} should be \texttt{.TRUE.}. Then, one has to choose the fitting algorithm \ref{tag:LSTYPE} among \texttt{LMDIF} and \texttt{GA}. In this example, we will take \texttt{LMDIF} as a fitting algorithm. For the \texttt{GA} method, please find the example in "\texttt{Example/Graphene/BAND\_FIT/Step\_1.genetic\_algorithm/}" of your example folder.
		 
	
		The users must pay some time to "\ref{tag:SET} \ref{tag:WEIGHT}" which is quite important in fitting procedures. If you want to fit more tightly than the other regions of your target band structure, you can put much higher value for that particular region. In this example, we have  16 atomic orbitals (2 atoms $\times$ 4 orbitals per atom $\{s, p_x, p_y, p_z\}$ $\times$ 2 spinors) in total. The target band structure, which is calculated by \href{https://www.vasp.at}{\texttt{VASP}}, also have 16 band structure. In the \ref{tag:INCAR_TB} file below, we give 5 weights. 
		
			The first line,
		    \begin{Verbatim}
             KRANGE : TBABND : DFTBND 1:16 WEIGHT 1
		    \end{Verbatim}
			indicates that the all the k-range (:), and all the tight binding band structure (:), and first sixteen bands (1:16) of DFT target band structure will be weighted with "1".

			And the second line,
		    \begin{Verbatim}
             KRANGE : TBABND 1:8 DFTBND 1:8 WEIGHT 7
		    \end{Verbatim}
			indicates that the all the k-range (:), and first eight tight binding bands (1:8) will be targeted to the first eight (1:8) of DFT band structure with weight of "7". Hence, the valence bands will be much more tightly fitted.

			And the third line,
		    \begin{Verbatim}
             KRANGE 10:51 TBABND 5:10 DFTBND 5:10 WEIGHT 27
		    \end{Verbatim}
			indicates that the particular k-range (10:51, around $M$-$K$ rigion), and 5-th to 10-th tight binding bands (5:10) will be targeted to those of DFT band structure with much larger weight of "27". The bands near the Fermi level and near the Dirac point will be fitted tightly. For the other lines, the same rules can be applied. 
		
			Next, the basic control tags should be informed.
			For example, \ref{tag:MITER}, \ref{tag:PTOL}, \ref{tag:FTOL}, \ref{tag:PFILE}, \ref{tag:POFILE}, \ref{tag:EFILE} ..., etc.
			
			And then, one should specify whether your system is one of
			followings: $nonmagnetic$, $noncollinear$, $collinear$,
			which can be defined by \ref{tag:TYPMAG}, together with 
			\ref{tag:LSORB} which is for the spin-orbit coupling effect.
			If you have put some \ref{tag:param-locpot} tag in your \ref{tag:PFILE} to consider some local potential, you should turn on \ref{tag:LOCCHG} to \texttt{.TRUE.}, and add some relevant parameters (see \ref{tag:param-locpot} for the details) into the \ref{tag:PFILE} to manage the strength of the local potential. 
			The tag \ref{tag:IS_SK} is to make sure that the hopping integral evaluation will follow the Slater and Koster's rule\footnote{\texttt{J. C. Slater and G. F. Koster,``Simplified LCAO Method for the Periodic Potential Problem'',
		\href{https://journals.aps.org/pr/abstract/10.1103/PhysRev.94.1498}
		{Phys. Rev. 94, 1498 (1954)}}}. Note that in the current version, \ref{tag:IS_SK} = \texttt{.FALSE.} is experimental and under developing for the ease of use, so recommend to leave it to \texttt{.TRUE.}.
		
			Now you have to make some rule for the nearest neighbor ($nn$) hoppings by setting up ``\ref{tag:SET} \ref{tag:NNCLASS}" which defines interatomic hopping.
			Once you set $nn$ pair, the necessary hopping parameter for those hopping will be automatically determined and $\tbfitname$ will trying to find those parameters in your \ref{tag:PFILE}. The detailed syntax for the naming of hopping parameters can be found in Section-\ref{tag:PFILE-detail}: PFILE-detail. 
			
			Finally, with ``\ref{tag:SET} \ref{tag:CONSTRAINT}" tag, one can add some constraint rule between parameters or restrict the magnitude of the parameters by applying upper/lower bound to them. For example, here, we have assumed that every $p$ orbitals shall have same onsite energy. So by setting ``\texttt{e\_px\_C = e\_pz\_C}",  during the calculations, \texttt{e\_px\_C} value will be kept same as \texttt{e\_pz\_C}. 
			
		
			\begin{description}
			\item[\namedlabel{tag:INCAR_TB}{INCAR\_TB}] : control tags
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of INCAR-TB for Graphene,
    labelposition=bottomline]
     	
       \textgreen{\ref{tag:TBFIT}}   .TRUE.  
       \textgreen{\ref{tag:LSTYPE}}  \ref{tag:LMDIF} 
       \textgreen{\ref{tag:MITER}}   300  
       \textgreen{\ref{tag:PTOL}}    1E-7  
       \textgreen{\ref{tag:FTOL}}    1E-7  

       \textgreen{\ref{tag:GFILE}}   \ref{tag:POSCAR}  
       \textgreen{\ref{tag:KFILE}}   \ref{tag:KPOINTS}  
       \textgreen{\ref{tag:PFILE}}   \ref{tag:PARAM_FIT}
       \textgreen{\ref{tag:EFILE}}   \ref{tag:DFT_BAND} 
       \textgreen{\ref{tag:POFILE}}  PARAM_FIT.new.dat  

       \textgreen{\ref{tag:LOCCHG}}  .TRUE.  
       \textgreen{\ref{tag:TYPMAG}}  noncollinear  
       \textgreen{\ref{tag:LSORB}}  .TRUE.  
       \textgreen{\ref{tag:LORBIT}} .FALSE.  

     

       \textgreen{\ref{tag:SET}} \ref{tag:WEIGHT}  
           KRANGE  :         TBABND :       DFTBND 1:16  WEIGHT 1
           KRANGE  :         TBABND 1:8     DFTBND 1:8   WEIGHT 7
           KRANGE  10:51     TBABND 5:10    DFTBND 5:10  WEIGHT 27
           KRANGE  20:40     TBABND 1:4     DFTBND 1:4   WEIGHT 50
           KRANGE  1:8 53:80 TBABND 3:6     DFTBND 3:6   WEIGHT 10
       \textgreen{\textblue{END}} \ref{tag:WEIGHT}  
       
       \textgreen{\ref{tag:SET}} \ref{tag:NNCLASS}  
           C-C   : 1.8   R0 1.4145
       \textgreen{\textblue{END}} \ref{tag:NNCLASS}  

       \textgreen{\ref{tag:SET}} \ref{tag:CONSTRAINT}  
           e_px_C    = e_pz_C
           e_py_C    = e_pz_C
            e_s_C   >= -10
           e_px_C   >= -10
           e_py_C   >= -10
           e_pz_C   >= -10
         sss_1_CC   >= -10
         sps_1_CC   >= -10
         pps_1_CC   >= -10
         ppp_1_CC   >= -10
       lambda_p_C   >= -10
            e_s_C   <= 10
           e_px_C   <= 10
           e_py_C   <= 10
           e_pz_C   <= 10
         sss_1_CC   <= 10
         sps_1_CC   <= 10
         pps_1_CC   <= 10
         ppp_1_CC   <= 10
       lambda_p_C   <= 10           
       \textgreen{\textblue{END}} \ref{tag:CONSTRAINT}  
\end{Verbatim}
		
		\subsubsection{Prepare parameter file: PARAM\_FIT}
		
		\item[\namedlabel{tag:PARAM_FIT}{PARAM\_FIT.dat}] : {\texttt{\ref{tag:PFILE}}}
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \ref{tag:PFILE} for Graphene,
    labelposition=bottomline]
    PRINT_INDEX  .TRUE.  # control tag for indexing parameters 
                          # (not affected on your actual calculations)
    USE_OVERLAP .TRUE. # control tag for the use of overlap integral
                         # parameters that specified with "o_" prefix.
    IS_SK  .TRUE. # default
    
    # index       param_name        parameter
     1                 e_s_C       -5.50250547
     2                e_px_C        0.27589107
     3                e_py_C        0.27589107
     4                e_pz_C        0.27589107
     5              sss_1_CC        4.14407741
     6              sps_1_CC        5.06877443
     7              pps_1_CC       -4.33297737
     8              ppp_1_CC        2.54569565
     9            o_sss_1_CC        0.02586060
    10            o_sps_1_CC       -0.04261519
    11            o_pps_1_CC        0.05063120
    12            o_ppp_1_CC        0.01711425
    13          lambda_p_C        0.00000000       
\end{Verbatim}
			
		\item[\namedlabel{tag:POSCAR}{POSCAR-TB}] : {\texttt{\ref{tag:GFILE}}}
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \ref{tag:GFILE} for Graphene,
    labelposition=bottomline]
     # Graphene with honeycomb lattice
       1.00000000000000
       2.45                  0.0000000000000000    0.0
       1.2250000000000000    2.1217622392718746    0.0
       0.0000000000000000    0.0000000000000000   15.0
       C
       2
       Direct coordinate
       0.16666666667  0.16666666667   0.0   s  px  py  pz
      -0.16666666667 -0.16666666667   0.0   s  px  py  pz
\end{Verbatim}
 Here, we have set $s$ and $p$ ($p_x$, $p_y$, and $p_z$) orbital basis for each carbon atom.

		\item[\namedlabel{tag:KPOINTS}{KPOINTS\_BAND}] : {\texttt{\ref{tag:KFILE}}}			
\begin{Verbatim}[commandchars=\\\{\},gobble=4, frame=single, framesep=2mm, 
    label= example of \ref{tag:KFILE} for Graphene,
    labelposition=bottomline]
     # k-points along high symmetry lines
       20  # number of division between each line segment.
       Line-mode 
       Reciprocal
       0 0 0                                           G
       0.50000000  0.500000000 0                       M
       
       0.50000000  0.500000000 0                       M
       0.33333333333333333333 0.66666666666666666667 0 K
       
       0.33333333333333333333 0.66666666666666666667 0 K
       0.00000000  0.000000000 0                       G
       
       0.00000000  0.000000000 0                       G
       0.00000000  0.000000000 0.5                     A
\end{Verbatim}
        Note that the file syntax is exactly same as \texttt{KPOINTS} file of 
        \href{https://www.vasp.at}{\texttt{VASP}} program.
        See \href{https://cms.mpi.univie.ac.at/wiki/index.php/KPOINTS}{\texttt{here}} for the details.
        
		\item[\namedlabel{tag:DFT_BAND}{DFT\_BAND.dat}] : {\texttt{\ref{tag:EFILE}}}
		
		For the details of the \texttt{EFILE}, please go to \ref{tag:EFILE} section and also please find the example file in 
		"\texttt{Example/Graphene/BAND\_FIT/Step\_2.lmdif\_method/}" of your example folder.
	
			\end{description}


\clearpage\printindex
\end{document}
